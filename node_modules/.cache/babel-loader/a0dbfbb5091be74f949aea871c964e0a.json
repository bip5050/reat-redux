{"ast":null,"code":"import _classCallCheck from\"/home/biplab/Desktop/foodjets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/biplab/Desktop/foodjets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/biplab/Desktop/foodjets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/biplab/Desktop/foodjets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import moment from'moment-timezone';import ReplyModal from'./replyModal';import React,{Component}from'react';import{ProgressBar}from'react-bootstrap';import Pagination from'../../Helper/pagination';import TaskDetailsModal from'./taskDetailsModal';import{isEmpty,isEqual,map as _map}from'lodash';import{avgCustomerFeedback}from'../../Helper/common';var List=/*#__PURE__*/function(_Component){_inherits(List,_Component);var _super=_createSuper(List);function List(props){var _this;_classCallCheck(this,List);_this=_super.call(this,props);_this.state={taskDetails:{},repliedIds:[],replyModalShow:false,filteredFeedbackData:[],orderDetailsModalShow:false};return _this;}_createClass(List,[{key:\"handleCloseModal\",value:function handleCloseModal(){this.setState({replyModalShow:false,orderDetailsModalShow:false});}},{key:\"handleOpenModal\",value:function handleOpenModal(e,type,ordObj){e.stopPropagation();if(type==='REPLY'){this.setState({replyModalShow:true,taskDetails:ordObj});}else if(type==='ORDERDETAILS'){this.setState({orderDetailsModalShow:true,taskDetails:ordObj});}}},{key:\"componentWillReceiveProps\",value:function componentWillReceiveProps(props){if(props.replyResult&&props.replyResult!==this.props.replyResult){var repliedIds=this.state.repliedIds||[];repliedIds.push(props.replyResult.task_id);this.setState({replyModalShow:false,orderDetailsModalShow:false,repliedIds:repliedIds});}this.setState({filteredFeedbackData:props.filteredFeedbackData});}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,replyModalShow=_this$state.replyModalShow,orderDetailsModalShow=_this$state.orderDetailsModalShow,taskDetails=_this$state.taskDetails,repliedIds=_this$state.repliedIds,filteredFeedbackData=_this$state.filteredFeedbackData;var totalFeedBack=this.props.feedbackSummeryData&&this.props.feedbackSummeryData.total_feedback?this.props.feedbackSummeryData.total_feedback:0;var feedbackSummery=this.props.feedbackSummeryData&&this.props.feedbackSummeryData.rows?this.props.feedbackSummeryData.rows:[];//pagination start here\nvar itemsPerPage=500;var totalRecords=this.props.feedBackCount||0;var avgRating=0;var ratingPrcnt=0;var totalRatingPrcnt=0;feedbackSummery.map(function(el,index){totalRatingPrcnt+=parseFloat(el.percentage);ratingPrcnt+=parseFloat(el.rating)*parseFloat(el.percentage);});avgRating=parseFloat(ratingPrcnt/totalRatingPrcnt);var avgStarObj=[];var avgStarObj1=[];var avgRatingObj=avgCustomerFeedback(avgRating);for(var s=1;s<=avgRatingObj.newwhole;s++){var key=\"star-\"+s;avgStarObj.push(/*#__PURE__*/React.createElement(\"img\",{key:key,src:\"/assets/star.svg\"}));};if(avgRatingObj.fraction==.5){avgStarObj.push(/*#__PURE__*/React.createElement(\"img\",{key:\"star-h\",src:\"/assets/star-h.svg\"}));};for(var _s=1;_s<=5-avgStarObj.length;_s++){var _key=\"star-g-\"+_s;avgStarObj1.push(/*#__PURE__*/React.createElement(\"img\",{key:_key,src:\"/assets/star-g.svg\"}));};// console.log('!!!!repliedIds!!!!!', repliedIds);\nreturn/*#__PURE__*/React.createElement(\"div\",null,!!!this.props.isLoading?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"section\",{className:\"feedback_wrap\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"titelFb\"},\"Customer Feedback\"),feedbackSummery.length>0?/*#__PURE__*/React.createElement(\"div\",{className:\"fbSecwrap\"},/*#__PURE__*/React.createElement(\"div\",{className:\"bstarPan\"},/*#__PURE__*/React.createElement(\"div\",{className:\"bstar_up\"},/*#__PURE__*/React.createElement(\"h3\",null,avgRating>0?avgRating.toFixed(2):0),/*#__PURE__*/React.createElement(\"span\",{className:\"big_star\"},avgStarObj,avgStarObj1)),/*#__PURE__*/React.createElement(\"div\",{className:\"bstar_down\"},\"based on \",totalFeedBack,\" ratings\")),/*#__PURE__*/React.createElement(\"div\",{className:\"statsbarPan\"},feedbackSummery.map(function(el,index){return/*#__PURE__*/React.createElement(\"div\",{key:\"rate-\".concat(index),className:\"gBar\"},/*#__PURE__*/React.createElement(\"label\",null,el.rating,\" Stars\"),/*#__PURE__*/React.createElement(\"div\",{className:\"bar\"},/*#__PURE__*/React.createElement(ProgressBar,{now:el.percentage})),/*#__PURE__*/React.createElement(\"span\",{className:\"totalP\"},el.feedback_count,\" Total\"));}))):null,/*#__PURE__*/React.createElement(\"div\",{className:\"filter_pan\"},/*#__PURE__*/React.createElement(\"span\",{className:\"ftitle\"},\"Filter by:\"),/*#__PURE__*/React.createElement(\"div\",{className:\"cbPan\"},/*#__PURE__*/React.createElement(\"input\",{onChange:this.props.handleCheckboxFilter,checked:this.props.allRatings,type:\"checkbox\",id:\"rating\",name:\"rating\",value:\"all\",className:\"c_box\"}),\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"fwb\"},\"All ratings\")),/*#__PURE__*/React.createElement(\"div\",{className:\"cbPan\"},/*#__PURE__*/React.createElement(\"input\",{onChange:this.props.handleCheckboxFilter,checked:this.props.filterByStart.includes('5'),type:\"checkbox\",id:\"rating\",name:\"rating\",value:\"5\",className:\"c_box\"}),\" \",/*#__PURE__*/React.createElement(\"span\",null,\"5 Stars\")),/*#__PURE__*/React.createElement(\"div\",{className:\"cbPan\"},/*#__PURE__*/React.createElement(\"input\",{onChange:this.props.handleCheckboxFilter,checked:this.props.filterByStart.includes('4'),type:\"checkbox\",id:\"rating\",name:\"rating\",value:\"4\",className:\"c_box\"}),\" \",/*#__PURE__*/React.createElement(\"span\",null,\"4 Stars\")),/*#__PURE__*/React.createElement(\"div\",{className:\"cbPan\"},/*#__PURE__*/React.createElement(\"input\",{onChange:this.props.handleCheckboxFilter,checked:this.props.filterByStart.includes('3'),type:\"checkbox\",id:\"rating\",name:\"rating\",value:\"3\",className:\"c_box\"}),\" \",/*#__PURE__*/React.createElement(\"span\",null,\"3 Stars\")),/*#__PURE__*/React.createElement(\"div\",{className:\"cbPan\"},/*#__PURE__*/React.createElement(\"input\",{onChange:this.props.handleCheckboxFilter,checked:this.props.filterByStart.includes('2'),type:\"checkbox\",id:\"rating\",name:\"rating\",value:\"2\",className:\"c_box\"}),\" \",/*#__PURE__*/React.createElement(\"span\",null,\"2 Stars\")),/*#__PURE__*/React.createElement(\"div\",{className:\"cbPan\"},/*#__PURE__*/React.createElement(\"input\",{onChange:this.props.handleCheckboxFilter,checked:this.props.filterByStart.includes('1'),type:\"checkbox\",id:\"rating\",name:\"rating\",value:\"1\",className:\"c_box\"}),\" \",/*#__PURE__*/React.createElement(\"span\",null,\"1 Stars\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"table_sec feed feedbackTable \".concat(this.props.isFiltering?\"tableloder\":\"\",\" \")},/*#__PURE__*/React.createElement(\"table\",null,/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Order Number\"),/*#__PURE__*/React.createElement(\"th\",null,\"Customer Name\"),/*#__PURE__*/React.createElement(\"th\",null,\"Date \\xB7 Time\"),/*#__PURE__*/React.createElement(\"th\",null,\"Rating\"),/*#__PURE__*/React.createElement(\"th\",null,\"Comments\"),/*#__PURE__*/React.createElement(\"th\",null,\"Follow Up\"))),!isEmpty(filteredFeedbackData)&&filteredFeedbackData.length>0?/*#__PURE__*/React.createElement(\"tbody\",null,filteredFeedbackData.length>0&&filteredFeedbackData.map(function(el,index){var starObj=[];var rate=el.rating?parseInt(el.rating):0;for(var i=0;i<rate;i++){starObj.push(/*#__PURE__*/React.createElement(\"img\",{key:\"star-sm-\".concat(i),src:\"/assets/star-sm.svg\"}));}// let date = moment(el.time_stamp).format(\"YYYY-MM-DD\");\nreturn/*#__PURE__*/React.createElement(\"tr\",{key:\"feedback-list-\".concat(index)},/*#__PURE__*/React.createElement(\"td\",null,el.tp_order_number,\" \",/*#__PURE__*/React.createElement(\"span\",{className:\"docmodbtn\",onClick:function onClick(e){return _this2.handleOpenModal(e,'ORDERDETAILS',el);}},/*#__PURE__*/React.createElement(\"img\",{src:\"/assets/doc.svg\"}))),/*#__PURE__*/React.createElement(\"td\",null,el.cust_first_name,\" \",el.cust_last_name),/*#__PURE__*/React.createElement(\"td\",null,el.time_stamp),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"starRange\"},starObj)),/*#__PURE__*/React.createElement(\"td\",{abbr:\"tr\",className:\"acell\"},/*#__PURE__*/React.createElement(\"label\",null,el.comment),el.comment?/*#__PURE__*/React.createElement(\"span\",{className:\"tTip\"},el.comment):null),/*#__PURE__*/React.createElement(\"td\",null,el.reply===\"true\"||repliedIds.indexOf(el.order_details.id)>-1?/*#__PURE__*/React.createElement(\"span\",{className:\"fbReply\",style:{cursor:'default'}},/*#__PURE__*/React.createElement(\"img\",{src:\"/assets/checkmark-black.svg\"})):/*#__PURE__*/React.createElement(\"span\",{className:\"fbReply\",onClick:function onClick(e){return _this2.handleOpenModal(e,'REPLY',el);}},\"Reply\")));})):/*#__PURE__*/React.createElement(\"tbody\",null,/*#__PURE__*/React.createElement(\"tr\",{className:\"no-records\"},/*#__PURE__*/React.createElement(\"td\",{colSpan:\"6\"},\"No Records\"))))),!!replyModalShow?/*#__PURE__*/React.createElement(ReplyModal,{reply:this.props.reply,isReplying:this.props.isReplying,replyModalShow:replyModalShow,handleCloseModal:this.handleCloseModal.bind(this),taskDetails:taskDetails}):null,!!orderDetailsModalShow?/*#__PURE__*/React.createElement(TaskDetailsModal,{isReplying:this.props.isReplying,orderDetailsModalShow:orderDetailsModalShow,handleCloseModal:this.handleCloseModal.bind(this),taskDetails:taskDetails}):null),totalRecords>=itemsPerPage?/*#__PURE__*/React.createElement(\"div\",{className:\"pagination_Pan\"},/*#__PURE__*/React.createElement(Pagination,{totalRecords:totalRecords,pageLimit:itemsPerPage,pageNeighbours:1,onPageChanged:this.props.changePage})):null):/*#__PURE__*/React.createElement(\"div\",{className:\"loader\"},\"Loading....\"));}}]);return List;}(Component);;export default List;","map":{"version":3,"sources":["/home/biplab/Desktop/foodjets/src/containers/Feedbacks/list.js"],"names":["moment","ReplyModal","React","Component","ProgressBar","Pagination","TaskDetailsModal","isEmpty","isEqual","map","_map","avgCustomerFeedback","List","props","state","taskDetails","repliedIds","replyModalShow","filteredFeedbackData","orderDetailsModalShow","setState","e","type","ordObj","stopPropagation","replyResult","push","task_id","totalFeedBack","feedbackSummeryData","total_feedback","feedbackSummery","rows","itemsPerPage","totalRecords","feedBackCount","avgRating","ratingPrcnt","totalRatingPrcnt","el","index","parseFloat","percentage","rating","avgStarObj","avgStarObj1","avgRatingObj","s","newwhole","key","fraction","length","isLoading","toFixed","feedback_count","handleCheckboxFilter","allRatings","filterByStart","includes","isFiltering","starObj","rate","parseInt","i","tp_order_number","handleOpenModal","cust_first_name","cust_last_name","time_stamp","comment","reply","indexOf","order_details","id","cursor","isReplying","handleCloseModal","bind","changePage"],"mappings":"gkBAAA,MAAOA,CAAAA,MAAP,KAAmB,iBAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,WAAT,KAA4B,iBAA5B,CACA,MAAOC,CAAAA,UAAP,KAAuB,yBAAvB,CACA,MAAOC,CAAAA,gBAAP,KAA6B,oBAA7B,CACA,OAASC,OAAT,CAAkBC,OAAlB,CAA2BC,GAAG,GAAIC,CAAAA,IAAlC,KAA8C,QAA9C,CACA,OAASC,mBAAT,KAAoC,qBAApC,C,GAEMC,CAAAA,I,4FACJ,cAAYC,KAAZ,CAAmB,sCACb,uBAAMA,KAAN,EACA,MAAKC,KAAL,CAAa,CACZC,WAAW,CAAC,EADA,CAEZC,UAAU,CAAE,EAFA,CAGlBC,cAAc,CAAE,KAHE,CAIZC,oBAAoB,CAAE,EAJV,CAKlBC,qBAAqB,CAAE,KALL,CAAb,CAFa,aAShB,C,4EAEc,CACjB,KAAKC,QAAL,CAAc,CAAEH,cAAc,CAAE,KAAlB,CAAyBE,qBAAqB,CAAE,KAAhD,CAAd,EACA,C,wDAEeE,C,CAAGC,I,CAAMC,M,CAAO,CAC/BF,CAAC,CAACG,eAAF,GAEA,GAAGF,IAAI,GAAK,OAAZ,CAAoB,CACnB,KAAKF,QAAL,CAAc,CAAEH,cAAc,CAAE,IAAlB,CAAwBF,WAAW,CAAEQ,MAArC,CAAd,EACA,CAFD,IAEO,IAAGD,IAAI,GAAK,cAAZ,CAA2B,CACjC,KAAKF,QAAL,CAAc,CAAED,qBAAqB,CAAE,IAAzB,CAA+BJ,WAAW,CAAEQ,MAA5C,CAAd,EACA,CACD,C,4EAEyBV,K,CAAO,CAChC,GAAGA,KAAK,CAACY,WAAN,EAAqBZ,KAAK,CAACY,WAAN,GAAsB,KAAKZ,KAAL,CAAWY,WAAzD,CAAqE,CACpE,GAAIT,CAAAA,UAAU,CAAG,KAAKF,KAAL,CAAWE,UAAX,EAAyB,EAA1C,CACSA,UAAU,CAACU,IAAX,CAAgBb,KAAK,CAACY,WAAN,CAAkBE,OAAlC,EAET,KAAKP,QAAL,CAAc,CAAEH,cAAc,CAAE,KAAlB,CAAyBE,qBAAqB,CAAE,KAAhD,CAAuDH,UAAU,CAAEA,UAAnE,CAAd,EACA,CAED,KAAKI,QAAL,CAAc,CAAEF,oBAAoB,CAAEL,KAAK,CAACK,oBAA9B,CAAd,EACG,C,uCAEK,iCACyF,KAAKJ,KAD9F,CACAG,cADA,aACAA,cADA,CACgBE,qBADhB,aACgBA,qBADhB,CACuCJ,WADvC,aACuCA,WADvC,CACoDC,UADpD,aACoDA,UADpD,CACgEE,oBADhE,aACgEA,oBADhE,CAER,GAAIU,CAAAA,aAAa,CAAI,KAAKf,KAAL,CAAWgB,mBAAX,EAAkC,KAAKhB,KAAL,CAAWgB,mBAAX,CAA+BC,cAAlE,CAAkF,KAAKjB,KAAL,CAAWgB,mBAAX,CAA+BC,cAAjH,CAAgI,CAApJ,CACA,GAAIC,CAAAA,eAAe,CAAI,KAAKlB,KAAL,CAAWgB,mBAAX,EAAkC,KAAKhB,KAAL,CAAWgB,mBAAX,CAA+BG,IAAlE,CAAwE,KAAKnB,KAAL,CAAWgB,mBAAX,CAA+BG,IAAvG,CAA4G,EAAlI,CAEA;AACA,GAAIC,CAAAA,YAAY,CAAG,GAAnB,CACA,GAAIC,CAAAA,YAAY,CAAG,KAAKrB,KAAL,CAAWsB,aAAX,EAA4B,CAA/C,CAEA,GAAIC,CAAAA,SAAS,CAAG,CAAhB,CACA,GAAIC,CAAAA,WAAW,CAAG,CAAlB,CACA,GAAIC,CAAAA,gBAAgB,CAAG,CAAvB,CAEAP,eAAe,CAACtB,GAAhB,CAAoB,SAAC8B,EAAD,CAAKC,KAAL,CAAe,CAClCF,gBAAgB,EAAKG,UAAU,CAACF,EAAE,CAACG,UAAJ,CAA/B,CACAL,WAAW,EAAKI,UAAU,CAACF,EAAE,CAACI,MAAJ,CAAV,CAAwBF,UAAU,CAACF,EAAE,CAACG,UAAJ,CAAlD,CACA,CAHD,EAKAN,SAAS,CAAGK,UAAU,CAACJ,WAAW,CAAGC,gBAAf,CAAtB,CAEA,GAAIM,CAAAA,UAAU,CAAG,EAAjB,CACA,GAAIC,CAAAA,WAAW,CAAG,EAAlB,CACA,GAAIC,CAAAA,YAAY,CAAGnC,mBAAmB,CAACyB,SAAD,CAAtC,CAEA,IAAI,GAAIW,CAAAA,CAAC,CAAC,CAAV,CAAaA,CAAC,EAAED,YAAY,CAACE,QAA7B,CAAuCD,CAAC,EAAxC,CAA2C,CAC1C,GAAIE,CAAAA,GAAG,CAAG,QAAQF,CAAlB,CACAH,UAAU,CAAClB,IAAX,cAAgB,2BAAK,GAAG,CAAEuB,GAAV,CAAe,GAAG,CAAC,kBAAnB,EAAhB,EACA,EAED,GAAGH,YAAY,CAACI,QAAb,EAAuB,EAA1B,CAA6B,CAC5BN,UAAU,CAAClB,IAAX,cAAgB,2BAAK,GAAG,CAAC,QAAT,CAAkB,GAAG,CAAC,oBAAtB,EAAhB,EACA,EAED,IAAI,GAAIqB,CAAAA,EAAC,CAAC,CAAV,CAAaA,EAAC,EAAK,EAAIH,UAAU,CAACO,MAAlC,CAA2CJ,EAAC,EAA5C,CAA+C,CAC9C,GAAIE,CAAAA,IAAG,CAAG,UAAUF,EAApB,CACAF,WAAW,CAACnB,IAAZ,cAAiB,2BAAK,GAAG,CAAEuB,IAAV,CAAe,GAAG,CAAC,oBAAnB,EAAjB,EACA,EAED;AAEA,mBACC,+BAEkB,CAAC,CAAC,CAAC,KAAKpC,KAAL,CAAWuC,SAAf,cACA,4CACd,+BAAS,SAAS,CAAC,eAAnB,eACC,0BAAI,SAAS,CAAC,SAAd,sBADD,CAIGrB,eAAe,CAACoB,MAAhB,CAAyB,CAA1B,cACA,2BAAK,SAAS,CAAC,WAAf,eACC,2BAAK,SAAS,CAAC,UAAf,eACC,2BAAK,SAAS,CAAC,UAAf,eACC,8BAAMf,SAAS,CAAG,CAAb,CAAgBA,SAAS,CAACiB,OAAV,CAAkB,CAAlB,CAAhB,CAAqC,CAA1C,CADD,cAEC,4BAAM,SAAS,CAAC,UAAhB,EAA4BT,UAA5B,CAAwCC,WAAxC,CAFD,CADD,cAMC,2BAAK,SAAS,CAAC,YAAf,cAAsCjB,aAAtC,YAND,CADD,cAYC,2BAAK,SAAS,CAAC,aAAf,EAEEG,eAAe,CAACtB,GAAhB,CAAoB,SAAC8B,EAAD,CAAKC,KAAL,CAAe,CAClC,mBACC,2BAAK,GAAG,gBAAUA,KAAV,CAAR,CAA2B,SAAS,CAAC,MAArC,eACC,iCAAQD,EAAE,CAACI,MAAX,UADD,cAEC,2BAAK,SAAS,CAAC,KAAf,eAAqB,oBAAC,WAAD,EAAa,GAAG,CAAEJ,EAAE,CAACG,UAArB,EAArB,CAFD,cAGC,4BAAM,SAAS,CAAC,QAAhB,EAA0BH,EAAE,CAACe,cAA7B,UAHD,CADD,CAOA,CARD,CAFF,CAZD,CADA,CA0BO,IA9BT,cAiCC,2BAAK,SAAS,CAAC,YAAf,eACC,4BAAM,SAAS,CAAC,QAAhB,eADD,cAEC,2BAAK,SAAS,CAAC,OAAf,eACC,6BAAO,QAAQ,CAAE,KAAKzC,KAAL,CAAW0C,oBAA5B,CAAkD,OAAO,CAAE,KAAK1C,KAAL,CAAW2C,UAAtE,CAAkF,IAAI,CAAC,UAAvF,CAAkG,EAAE,CAAC,QAArG,CAA8G,IAAI,CAAC,QAAnH,CAA4H,KAAK,CAAC,KAAlI,CAAwI,SAAS,CAAC,OAAlJ,EADD,kBAC8J,4BAAM,SAAS,CAAC,KAAhB,gBAD9J,CAFD,cAMC,2BAAK,SAAS,CAAC,OAAf,eACC,6BAAO,QAAQ,CAAE,KAAK3C,KAAL,CAAW0C,oBAA5B,CAAkD,OAAO,CAAG,KAAK1C,KAAL,CAAW4C,aAAX,CAAyBC,QAAzB,CAAkC,GAAlC,CAA5D,CAAqG,IAAI,CAAC,UAA1G,CAAqH,EAAE,CAAC,QAAxH,CAAiI,IAAI,CAAC,QAAtI,CAA+I,KAAK,CAAC,GAArJ,CAAyJ,SAAS,CAAC,OAAnK,EADD,kBAC+K,0CAD/K,CAND,cAUC,2BAAK,SAAS,CAAC,OAAf,eACC,6BAAO,QAAQ,CAAE,KAAK7C,KAAL,CAAW0C,oBAA5B,CAAkD,OAAO,CAAG,KAAK1C,KAAL,CAAW4C,aAAX,CAAyBC,QAAzB,CAAkC,GAAlC,CAA5D,CAAqG,IAAI,CAAC,UAA1G,CAAqH,EAAE,CAAC,QAAxH,CAAiI,IAAI,CAAC,QAAtI,CAA+I,KAAK,CAAC,GAArJ,CAAyJ,SAAS,CAAC,OAAnK,EADD,kBAC+K,0CAD/K,CAVD,cAcC,2BAAK,SAAS,CAAC,OAAf,eACC,6BAAO,QAAQ,CAAE,KAAK7C,KAAL,CAAW0C,oBAA5B,CAAkD,OAAO,CAAG,KAAK1C,KAAL,CAAW4C,aAAX,CAAyBC,QAAzB,CAAkC,GAAlC,CAA5D,CAAqG,IAAI,CAAC,UAA1G,CAAqH,EAAE,CAAC,QAAxH,CAAiI,IAAI,CAAC,QAAtI,CAA+I,KAAK,CAAC,GAArJ,CAAyJ,SAAS,CAAC,OAAnK,EADD,kBAC+K,0CAD/K,CAdD,cAkBC,2BAAK,SAAS,CAAC,OAAf,eACC,6BAAO,QAAQ,CAAE,KAAK7C,KAAL,CAAW0C,oBAA5B,CAAkD,OAAO,CAAG,KAAK1C,KAAL,CAAW4C,aAAX,CAAyBC,QAAzB,CAAkC,GAAlC,CAA5D,CAAqG,IAAI,CAAC,UAA1G,CAAqH,EAAE,CAAC,QAAxH,CAAiI,IAAI,CAAC,QAAtI,CAA+I,KAAK,CAAC,GAArJ,CAAyJ,SAAS,CAAC,OAAnK,EADD,kBAC+K,0CAD/K,CAlBD,cAsBC,2BAAK,SAAS,CAAC,OAAf,eACC,6BAAO,QAAQ,CAAE,KAAK7C,KAAL,CAAW0C,oBAA5B,CAAkD,OAAO,CAAG,KAAK1C,KAAL,CAAW4C,aAAX,CAAyBC,QAAzB,CAAkC,GAAlC,CAA5D,CAAqG,IAAI,CAAC,UAA1G,CAAqH,EAAE,CAAC,QAAxH,CAAiI,IAAI,CAAC,QAAtI,CAA+I,KAAK,CAAC,GAArJ,CAAyJ,SAAS,CAAC,OAAnK,EADD,kBAC+K,0CAD/K,CAtBD,CAjCD,cA4DC,2BAAK,SAAS,wCAAkC,KAAK7C,KAAL,CAAW8C,WAAX,CAAyB,YAAzB,CAAsC,EAAxE,KAAd,eACC,8CACC,8CACC,2CACC,6CADD,cAEC,8CAFD,cAGC,+CAHD,cAIC,uCAJD,cAKC,yCALD,cAMC,0CAND,CADD,CADD,CAaI,CAACpD,OAAO,CAACW,oBAAD,CAAR,EAAkCA,oBAAoB,CAACiC,MAArB,CAA8B,CAAjE,cACD,iCAEGjC,oBAAoB,CAACiC,MAArB,CAA8B,CAA/B,EAAqCjC,oBAAoB,CAACT,GAArB,CAAyB,SAAC8B,EAAD,CAAKC,KAAL,CAAe,CAC5E,GAAIoB,CAAAA,OAAO,CAAG,EAAd,CACA,GAAIC,CAAAA,IAAI,CAAItB,EAAE,CAACI,MAAJ,CAAYmB,QAAQ,CAACvB,EAAE,CAACI,MAAJ,CAApB,CAAgC,CAA3C,CAEA,IAAK,GAAIoB,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGF,IAApB,CAA0BE,CAAC,EAA3B,CAA+B,CAC9BH,OAAO,CAAClC,IAAR,cAAa,2BAAK,GAAG,mBAAaqC,CAAb,CAAR,CAA0B,GAAG,CAAC,qBAA9B,EAAb,EACA,CAED;AACA,mBACC,0BAAI,GAAG,yBAAmBvB,KAAnB,CAAP,eACC,8BAAKD,EAAE,CAACyB,eAAR,kBAAyB,4BAAM,SAAS,CAAC,WAAhB,CAA4B,OAAO,CAAE,iBAAC3C,CAAD,QAAQ,CAAA,MAAI,CAAC4C,eAAL,CAAqB5C,CAArB,CAAwB,cAAxB,CAAwCkB,EAAxC,CAAR,EAArC,eAA0F,2BAAK,GAAG,CAAC,iBAAT,EAA1F,CAAzB,CADD,cAEC,8BAAKA,EAAE,CAAC2B,eAAR,KAA0B3B,EAAE,CAAC4B,cAA7B,CAFD,cAGC,8BAAK5B,EAAE,CAAC6B,UAAR,CAHD,cAIC,2CAAI,2BAAK,SAAS,CAAC,WAAf,EAA4BR,OAA5B,CAAJ,CAJD,cAKE,0BAAI,IAAI,CAAC,IAAT,CAAc,SAAS,CAAC,OAAxB,eACC,iCAAQrB,EAAE,CAAC8B,OAAX,CADD,CAGG9B,EAAE,CAAC8B,OAAJ,cACA,4BAAM,SAAS,CAAC,MAAhB,EAAwB9B,EAAE,CAAC8B,OAA3B,CADA,CAC2C,IAJ7C,CALF,cAYC,8BAEG9B,EAAE,CAAC+B,KAAH,GAAa,MAAb,EAAwBtD,UAAU,CAACuD,OAAX,CAAmBhC,EAAE,CAACiC,aAAH,CAAiBC,EAApC,EAA0C,CAAC,CAApE,cACA,4BAAM,SAAS,CAAC,SAAhB,CAA0B,KAAK,CAAE,CAACC,MAAM,CAAE,SAAT,CAAjC,eAAsD,2BAAK,GAAG,CAAC,6BAAT,EAAtD,CADA,cAGA,4BAAM,SAAS,CAAC,SAAhB,CAA0B,OAAO,CAAE,iBAACrD,CAAD,QAAQ,CAAA,MAAI,CAAC4C,eAAL,CAAqB5C,CAArB,CAAwB,OAAxB,CAAiCkB,EAAjC,CAAR,EAAnC,UALF,CAZD,CADD,CAuBA,CAhCoC,CAFvC,CADC,cAsCA,8CAAO,0BAAI,SAAS,CAAC,YAAd,eAA2B,0BAAI,OAAO,CAAC,GAAZ,eAA3B,CAAP,CAnDH,CADD,CA5DD,CAsHG,CAAC,CAACtB,cAAH,cACA,oBAAC,UAAD,EAAY,KAAK,CAAE,KAAKJ,KAAL,CAAWyD,KAA9B,CAAqC,UAAU,CAAE,KAAKzD,KAAL,CAAW8D,UAA5D,CAAwE,cAAc,CAAE1D,cAAxF,CAAwG,gBAAgB,CAAE,KAAK2D,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CAA1H,CAA4J,WAAW,CAAE9D,WAAzK,EADA,CAC2L,IAvH7L,CA2HG,CAAC,CAACI,qBAAH,cACA,oBAAC,gBAAD,EAAkB,UAAU,CAAE,KAAKN,KAAL,CAAW8D,UAAzC,CAAqD,qBAAqB,CAAExD,qBAA5E,CAAmG,gBAAgB,CAAE,KAAKyD,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CAArH,CAAuJ,WAAW,CAAE9D,WAApK,EADA,CACsL,IA5HxL,CADc,CAkIbmB,YAAY,EAAID,YAAhB,cACA,2BAAK,SAAS,CAAC,gBAAf,eAAgC,oBAAC,UAAD,EAAY,YAAY,CAAEC,YAA1B,CAAwC,SAAS,CAAED,YAAnD,CAAiE,cAAc,CAAE,CAAjF,CAAoF,aAAa,CAAE,KAAKpB,KAAL,CAAWiE,UAA9G,EAAhC,CADA,CACmK,IAnItJ,CADA,cAsIA,2BAAK,SAAS,CAAC,QAAf,gBAxIjB,CADD,CA6IA,C,kBA1NiB3E,S,EA2NlB,CAED,cAAeS,CAAAA,IAAf","sourcesContent":["import moment from 'moment-timezone';\nimport ReplyModal from './replyModal';\nimport React, { Component } from 'react';\nimport { ProgressBar } from 'react-bootstrap';\nimport Pagination from '../../Helper/pagination';\nimport TaskDetailsModal from './taskDetailsModal';\nimport { isEmpty, isEqual, map as _map } from 'lodash';\nimport { avgCustomerFeedback } from '../../Helper/common';\n\nclass List extends Component {\n \tconstructor(props) {\n        super(props);\n        this.state = {     \n        \ttaskDetails:{},\t   \n        \trepliedIds: [], \n\t\t\treplyModalShow: false,\n        \tfilteredFeedbackData: [],\t\n\t\t\torderDetailsModalShow: false\n        }\n    };\n\n\thandleCloseModal(){\n\t\tthis.setState({ replyModalShow: false, orderDetailsModalShow: false });\n\t};\n\n\thandleOpenModal(e, type, ordObj){\n\t\te.stopPropagation();\n\t\t\n\t\tif(type === 'REPLY'){\n\t\t\tthis.setState({ replyModalShow: true, taskDetails: ordObj });\n\t\t} else if(type === 'ORDERDETAILS'){\n\t\t\tthis.setState({ orderDetailsModalShow: true, taskDetails: ordObj });\n\t\t}\n\t};\n\n\tcomponentWillReceiveProps(props) {\n\t\tif(props.replyResult && props.replyResult !== this.props.replyResult){\n\t\t\tlet repliedIds = this.state.repliedIds || [];\n            repliedIds.push(props.replyResult.task_id);\n\n\t\t\tthis.setState({ replyModalShow: false, orderDetailsModalShow: false, repliedIds: repliedIds });\n\t\t}\n\n\t\tthis.setState({ filteredFeedbackData: props.filteredFeedbackData });\n    }; \t\n\n\trender() {\n\t\tconst { replyModalShow, orderDetailsModalShow, taskDetails, repliedIds, filteredFeedbackData } = this.state;\n\t\tlet totalFeedBack = (this.props.feedbackSummeryData && this.props.feedbackSummeryData.total_feedback)?this.props.feedbackSummeryData.total_feedback:0; \n\t\tlet feedbackSummery = (this.props.feedbackSummeryData && this.props.feedbackSummeryData.rows)?this.props.feedbackSummeryData.rows:[]; \n\n\t\t//pagination start here\n\t\tlet itemsPerPage = 500;\n\t\tlet totalRecords = this.props.feedBackCount || 0;\n\n\t\tlet avgRating = 0;\n\t\tlet ratingPrcnt = 0;\n\t\tlet totalRatingPrcnt = 0;\n\n\t\tfeedbackSummery.map((el, index) => {\n\t\t\ttotalRatingPrcnt += (parseFloat(el.percentage));\n\t\t\tratingPrcnt += (parseFloat(el.rating) * parseFloat(el.percentage));\n\t\t});\n\n\t\tavgRating = parseFloat(ratingPrcnt / totalRatingPrcnt);\n\n\t\tlet avgStarObj = [];\n\t\tlet avgStarObj1 = [];\n\t\tlet avgRatingObj = avgCustomerFeedback(avgRating);\n\n\t\tfor(let s=1; s<=avgRatingObj.newwhole; s++){\n\t\t\tlet key = \"star-\"+s;\n\t\t\tavgStarObj.push(<img key={key} src=\"/assets/star.svg\" />);\n\t\t};\n\n\t\tif(avgRatingObj.fraction==.5){\n\t\t\tavgStarObj.push(<img key=\"star-h\" src=\"/assets/star-h.svg\" />);\n\t\t};\n\n\t\tfor(let s=1; s <= (5 - avgStarObj.length); s++){\n\t\t\tlet key = \"star-g-\"+s;\n\t\t\tavgStarObj1.push(<img key={key} src=\"/assets/star-g.svg\" />);\n\t\t};\n\n\t\t// console.log('!!!!repliedIds!!!!!', repliedIds);\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t{\n                    (!!!this.props.isLoading)?\n                    <div>                    \t              \t\t\t\n\t\t\t\t\t\t<section className=\"feedback_wrap\">\n\t\t\t\t\t\t\t<h4 className=\"titelFb\">Customer Feedback</h4>\n\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t(feedbackSummery.length > 0)?\n\t\t\t\t\t\t\t\t<div className=\"fbSecwrap\">\n\t\t\t\t\t\t\t\t\t<div className=\"bstarPan\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"bstar_up\">\n\t\t\t\t\t\t\t\t\t\t\t<h3>{(avgRating > 0)?avgRating.toFixed(2):0}</h3>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"big_star\">{avgStarObj}{avgStarObj1}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div className=\"bstar_down\">based on {totalFeedBack} ratings</div>\n\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div className=\"statsbarPan\">\n\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tfeedbackSummery.map((el, index) => {\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div key={`rate-${index}`} className=\"gBar\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<label>{el.rating} Stars</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"bar\"><ProgressBar now={el.percentage} /></div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"totalP\">{el.feedback_count} Total</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>:null\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t<div className=\"filter_pan\">\n\t\t\t\t\t\t\t\t<span className=\"ftitle\">Filter by:</span>\n\t\t\t\t\t\t\t\t<div className=\"cbPan\">\n\t\t\t\t\t\t\t\t\t<input onChange={this.props.handleCheckboxFilter} checked={this.props.allRatings} type=\"checkbox\" id=\"rating\" name=\"rating\" value=\"all\" className=\"c_box\" /> <span className=\"fwb\">All ratings</span>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div className=\"cbPan\">\n\t\t\t\t\t\t\t\t\t<input onChange={this.props.handleCheckboxFilter} checked={(this.props.filterByStart.includes('5'))} type=\"checkbox\" id=\"rating\" name=\"rating\" value=\"5\" className=\"c_box\" /> <span>5 Stars</span>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div className=\"cbPan\">\n\t\t\t\t\t\t\t\t\t<input onChange={this.props.handleCheckboxFilter} checked={(this.props.filterByStart.includes('4'))} type=\"checkbox\" id=\"rating\" name=\"rating\" value=\"4\" className=\"c_box\" /> <span>4 Stars</span>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div className=\"cbPan\">\n\t\t\t\t\t\t\t\t\t<input onChange={this.props.handleCheckboxFilter} checked={(this.props.filterByStart.includes('3'))} type=\"checkbox\" id=\"rating\" name=\"rating\" value=\"3\" className=\"c_box\" /> <span>3 Stars</span>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div className=\"cbPan\">\n\t\t\t\t\t\t\t\t\t<input onChange={this.props.handleCheckboxFilter} checked={(this.props.filterByStart.includes('2'))} type=\"checkbox\" id=\"rating\" name=\"rating\" value=\"2\" className=\"c_box\" /> <span>2 Stars</span>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div className=\"cbPan\">\n\t\t\t\t\t\t\t\t\t<input onChange={this.props.handleCheckboxFilter} checked={(this.props.filterByStart.includes('1'))} type=\"checkbox\" id=\"rating\" name=\"rating\" value=\"1\" className=\"c_box\" /> <span>1 Stars</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className={`table_sec feed feedbackTable ${this.props.isFiltering ? \"tableloder\":\"\"} `}>\n\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<th>Order Number</th>\n\t\t\t\t\t\t\t\t\t\t\t<th>Customer Name</th>\n\t\t\t\t\t\t\t\t\t\t\t<th>Date · Time</th>\n\t\t\t\t\t\t\t\t\t\t\t<th>Rating</th>\n\t\t\t\t\t\t\t\t\t\t\t<th>Comments</th>\n\t\t\t\t\t\t\t\t\t\t\t<th>Follow Up</th>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</thead>\n\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t \t(!isEmpty(filteredFeedbackData) && filteredFeedbackData.length > 0) ? \n\t\t\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t(filteredFeedbackData.length > 0) && filteredFeedbackData.map((el, index) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet starObj = [];\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet rate = (el.rating)?parseInt(el.rating):0;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < rate; i++) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstarObj.push(<img key={`star-sm-${i}`} src=\"/assets/star-sm.svg\" />);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t// let date = moment(el.time_stamp).format(\"YYYY-MM-DD\");\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr key={`feedback-list-${index}`}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>{el.tp_order_number} <span className=\"docmodbtn\" onClick={(e)  => this.handleOpenModal(e, 'ORDERDETAILS', el)}><img src=\"/assets/doc.svg\" /></span></td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>{el.cust_first_name} {el.cust_last_name}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>{el.time_stamp}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td><div className=\"starRange\">{starObj}</div></td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t<td abbr=\"tr\" className=\"acell\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t<label>{el.comment}</label> \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t\t\t(el.comment)?\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t\t<span className=\"tTip\">{el.comment}</span>:null\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(el.reply === \"true\" || (repliedIds.indexOf(el.order_details.id) > -1) )?\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"fbReply\" style={{cursor: 'default'}}><img src=\"/assets/checkmark-black.svg\" /></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"fbReply\" onClick={(e)  => this.handleOpenModal(e, 'REPLY', el)}>Reply</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t\t\t:<tbody><tr className=\"no-records\"><td colSpan=\"6\">No Records</td></tr></tbody> \n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t(!!replyModalShow) ?\n\t\t\t\t\t\t\t\t<ReplyModal reply={this.props.reply} isReplying={this.props.isReplying} replyModalShow={replyModalShow} handleCloseModal={this.handleCloseModal.bind(this)} taskDetails={taskDetails} /> : null\n\t\t\t\t\t\t\t} \n\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t(!!orderDetailsModalShow) ?\n\t\t\t\t\t\t\t\t<TaskDetailsModal isReplying={this.props.isReplying} orderDetailsModalShow={orderDetailsModalShow} handleCloseModal={this.handleCloseModal.bind(this)} taskDetails={taskDetails} /> : null\n\t\t\t\t\t\t\t} \n\t\t\t        \t</section>\t\n\t\t\t        \t\n\t\t\t        \t{\n\t\t\t\t\t\t\ttotalRecords >= itemsPerPage ?\n\t\t\t\t\t\t\t<div className=\"pagination_Pan\"><Pagination totalRecords={totalRecords} pageLimit={itemsPerPage} pageNeighbours={1} onPageChanged={this.props.changePage} /></div>:null\n\t                  \t}\t\t\t        \t\n\t\t        \t</div> : <div className=\"loader\">Loading....</div>\n\t\t        }\n        \t</div>       \t\n\t\t)\n\t};\n};\n\nexport default List;"]},"metadata":{},"sourceType":"module"}