{"ast":null,"code":"import _objectSpread from\"/home/biplab/Desktop/foodjets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/biplab/Desktop/foodjets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(getLocations),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(getTaskDetails),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(getTrackDetails),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(createTask),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(deleteTask),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(updateTaskStatus),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(editTask),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(search),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(updateFilter),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(getShoppedLate),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(watchDashboardStore);import{takeEvery,put,call,all}from'redux-saga/effects';import*as dashboardConstant from'../constants';import{error as notifyerror,success as notifysuccess}from'../../../util/notify';import*as dashboardAction from'../actions';import*as headerAction from'../../Header/actions';import{callApi,callApiV2,callOnFleetApi}from'../../../Helper/api';import moment from'moment-timezone';import*as _ from'lodash';import{isEmpty,compact}from'lodash';import{getDateTime,getSysDateTime,getFilter}from'../../../Helper/common';//Get Locations & Zones\nexport function getLocations(action){var url,statesLocalStorage,states,res,payload,zone,zoneList,taskType,pharmacy,locations,stores,result,user;return _regeneratorRuntime.wrap(function getLocations$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;url='';statesLocalStorage=JSON.parse(localStorage.getItem('states')||'[]');states=statesLocalStorage.map(function(item){return item.id;});url=\"location/all\";_context.next=7;return all([call(callApi,'GET',url),call(callApiV2,'POST','location/zones',{\"state\":states})]);case 7:res=_context.sent;if(!res){_context.next=29;break;}payload=res[0];zone=res[1];// check for error    \nif(!payload.data.error){_context.next=14;break;}_context.next=14;return put(dashboardAction.listenGetLocationsError());case 14:if(!payload.data.result){_context.next=29;break;}zoneList={};taskType='';pharmacy=false;locations=[];stores=[];result=payload.data.result;user=payload.data.user;if(user.user_type==='pharmacy'){taskType=\"pharmacy\";pharmacy=true;}else if(user.user_type==='general'){taskType=\"general\";pharmacy=false;}else{taskType=\"admin\";pharmacy=false;}result.map(function(v,k){locations[k]={id:v.id,value:k,label:v.address,data:v};if(v.store!==''&&v.store!==null){stores[k]={id:v.id,zone_id:v.zone_id,value:k,label:v.store,data:v};}});stores=compact(stores);locations=compact(locations);if(!!zone.data){zoneList=zone.data||{};}_context.next=29;return put(dashboardAction.listenGetLocationsSuccess({taskType:taskType,pharmacy:pharmacy,locations:locations,stores:stores,zones:zoneList}));case 29:_context.next=35;break;case 31:_context.prev=31;_context.t0=_context[\"catch\"](0);notifyerror(_context.t0);console.log(_context.t0.message);case 35:case\"end\":return _context.stop();}}},_marked,null,[[0,31]]);}//Get Locations & Zones\nexport function getTaskDetails(action){var url,payload;return _regeneratorRuntime.wrap(function getTaskDetails$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;url='';url=\"tasks/\".concat(action.data.uuid);_context2.next=5;return call(callApiV2,'GET',url);case 5:payload=_context2.sent;if(!payload.data.error){_context2.next=9;break;}_context2.next=9;return put(dashboardAction.listenGetTaskDetailsError());case 9:if(!payload.data){_context2.next=12;break;}_context2.next=12;return put(dashboardAction.listenGetTaskDetailsSuccess(payload.data));case 12:_context2.next=18;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](0);notifyerror(_context2.t0.message);console.log(_context2.t0.message);case 18:case\"end\":return _context2.stop();}}},_marked2,null,[[0,14]]);}//Get Track Details\nexport function getTrackDetails(action){var url,payload;return _regeneratorRuntime.wrap(function getTrackDetails$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;url='';url=\"tasks/\".concat(action.data.uuid);_context3.next=5;return call(callOnFleetApi,'GET',url);case 5:payload=_context3.sent;// check for error    \nif(payload.data.error){//yield put(dashboardAction.listenGetTaskDetailsError());\n}// handle success result\nif(payload.data){//yield put(dashboardAction.listenGetTaskDetailsSuccess(payload.data));\n}_context3.next=14;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](0);notifyerror(_context3.t0.message);console.log(_context3.t0.message);case 14:case\"end\":return _context3.stop();}}},_marked3,null,[[0,10]]);}//Create Task\nexport function createTask(action){var url,payload;return _regeneratorRuntime.wrap(function createTask$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;url='';url=\"tasks\";_context4.next=5;return call(callApi,'POST',url,action.data);case 5:payload=_context4.sent;if(!payload.data.error){_context4.next=10;break;}console.log(payload.data.error);_context4.next=10;return put(dashboardAction.listenCreateTaskError());case 10:if(!payload.data){_context4.next=14;break;}notifysuccess({message:'Task has been created successfully'});_context4.next=14;return put(dashboardAction.listenCreateTaskSuccess({}));case 14:_context4.next=20;break;case 16:_context4.prev=16;_context4.t0=_context4[\"catch\"](0);notifyerror(_context4.t0.message);console.log(_context4.t0.message);case 20:case\"end\":return _context4.stop();}}},_marked4,null,[[0,16]]);}//Delete Task\nexport function deleteTask(action){var url,data,payload;return _regeneratorRuntime.wrap(function deleteTask$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;url='';url=\"tasks/\".concat(action.data.uuid);data={\"timestamp\":moment().format('X')};_context5.next=6;return call(callApi,'DELETE',url,data);case 6:payload=_context5.sent;if(!payload.data.error){_context5.next=10;break;}_context5.next=10;return put(dashboardAction.listenDeleteTaskError());case 10:if(!payload.data){_context5.next=14;break;}notifysuccess({message:'Task deleted successfully'});_context5.next=14;return put(dashboardAction.listenDeleteTaskSuccess({}));case 14:_context5.next=20;break;case 16:_context5.prev=16;_context5.t0=_context5[\"catch\"](0);notifyerror(_context5.t0.message);console.log(_context5.t0.message);case 20:case\"end\":return _context5.stop();}}},_marked5,null,[[0,16]]);}//Update Task Status\nexport function updateTaskStatus(action){var url,data,payload;return _regeneratorRuntime.wrap(function updateTaskStatus$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;url='';url=\"tasks/status/\".concat(action.data.uuid);data={orderStatus:{status:action.data.status}};_context6.next=6;return call(callApi,'PUT',url,data);case 6:payload=_context6.sent;if(!payload.data.error){_context6.next=10;break;}_context6.next=10;return put(dashboardAction.listenUpdateTaskStatusError());case 10:if(!payload.data){_context6.next=14;break;}notifysuccess({message:'Task status updated successfully'});_context6.next=14;return put(dashboardAction.listenUpdateTaskStatusSuccess({}));case 14:_context6.next=20;break;case 16:_context6.prev=16;_context6.t0=_context6[\"catch\"](0);notifyerror(_context6.t0.message);console.log(_context6.t0.message);case 20:case\"end\":return _context6.stop();}}},_marked6,null,[[0,16]]);}//Edit Task\nexport function editTask(action){var url,data,payload;return _regeneratorRuntime.wrap(function editTask$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;url='';url=\"tasks/\".concat(action.data.uuid);data=_objectSpread({},action.data.params);_context7.next=6;return call(callApi,'PUT',url,data);case 6:payload=_context7.sent;if(!payload.data.error){_context7.next=10;break;}_context7.next=10;return put(dashboardAction.listenEditTaskError());case 10:if(!payload.data){_context7.next=14;break;}//console.log('Success : ', payload.data);\nnotifysuccess({message:'Task updated successfully'});_context7.next=14;return put(dashboardAction.listenEditTaskSuccess({}));case 14:_context7.next=20;break;case 16:_context7.prev=16;_context7.t0=_context7[\"catch\"](0);//console.log('Catch : ', e, e.response, e.response.data, e.message.cause);\nif(_context7.t0.response&&!!_context7.t0.response.data){notifyerror({message:_context7.t0.response.data.message.cause});}else{notifyerror({message:_context7.t0.message});}console.log(_context7.t0.message);case 20:case\"end\":return _context7.stop();}}},_marked7,null,[[0,16]]);}//Get Search\nexport function search(action){var url,data,payload,result,tasks,temp;return _regeneratorRuntime.wrap(function search$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;url='';url=\"tasks/search\";data={userType:action.data.user_type,valueOne:action.data.type,valueTwo:action.data.value};if(!!action.data.dateType){data.dateType=action.data.dateType;}_context8.next=7;return call(callApiV2,'POST',url,data);case 7:payload=_context8.sent;if(!payload.data.error){_context8.next=11;break;}_context8.next=11;return put(dashboardAction.listenSearchError());case 11:if(!payload.data.result){_context8.next=20;break;}result=payload.data.result;tasks={};if(result.tasks.length>0){result.tasks.map(function(val,key){var recipient_sig=false;var track_driver='';var current_url='';var tskStatus='Scheduled';if(val.tskStatus==='tsk_proc_hld'){tskStatus='Scheduled';}else if(val.tskStatus==='tsk_proc_mrchnt'){tskStatus='Scheduled';}else if(val.tskStatus==='tsk_proc_drv'&&val.driverStatus==='drv_strt_recpnt_tsk'){tskStatus='Picked Up';}else if(val.tskStatus==='tsk_proc_drv'){tskStatus='Processing';}else if(val.tskStatus==='tsk_cmp'){tskStatus='Completed';}else if(val.tskStatus==='tsk_cncling'){tskStatus='Deleted';}else if(val.tskStatus==='tsk_cncled'){tskStatus='Deleted';}var dt=val.timeCreated.split('T');var d=dt[0].split('-');var created_at=d[1]+'/'+d[2]+'/'+d[0];var completeafter='';var completebefore='';if(val.timezone!==''){completeafter=getDateTime(parseInt(val.completeAfter)*1000,val.timezone,'MM/DD 路 hh:mma');completebefore=getDateTime(parseInt(val.completeBefore)*1000,val.timezone,'hh:mma');}else{completeafter=getSysDateTime(parseInt(val.completeAfter)*1000,'MM/DD 路 hh:mma');completebefore=getSysDateTime(parseInt(val.completeBefore)*1000,'hh:mma');}if(!isEmpty(val.completionDetails.events)&&!!val.completionDetails.events.onflt_recpnt_sig){recipient_sig=true;}if(!isEmpty(val.completionDetails.events)&&!!val.completionDetails.events.onflt_recpnt_sig){recipient_sig=true;}if(!!val.pickup_onfleet_url){track_driver='Driver to Merchant';current_url=val.pickup_onfleet_url;}if(!!val.drop_onfleet_url){track_driver='Driver to Recipient';current_url=val.drop_onfleet_url;}if(!!!tasks[val.state_code]){tasks[val.state_code]={};tasks[val.state_code][val.mkt_ofc_cty_del_zne_id]={name:val.mkt_ofc_cty_del_zne_name,id:val.state_code+val.mkt_ofc_cty_del_zne_id,orders:[]};}else{if(!!!tasks[val.state_code][val.mkt_ofc_cty_del_zne_id]){tasks[val.state_code][val.mkt_ofc_cty_del_zne_id]={name:val.mkt_ofc_cty_del_zne_name,id:val.state_code+val.mkt_ofc_cty_del_zne_id,orders:[]};}}tasks[val.state_code][val.mkt_ofc_cty_del_zne_id].orders.push({created_at:created_at,complete_after:completeafter,complete_before:completebefore,recpnt_address:val.recipients.address,mrchnt_address:val.merchant.address,mrchnt_notes:val.merchant.notes,recpnt_notes:val.recipients.notes,tsk_status:tskStatus,uuid:val.uuid,order_number:val.orderNumber,driver_name:val.driver_name,recipient_sig:recipient_sig,timezone:val.timezone,mrchnt_location:val.merchant.location,recpnt_location:val.recipients.location,drop_onfleet_url:val.drop_onfleet_url||'',pickup_onfleet_url:val.pickup_onfleet_url||'',track_driver:track_driver,current_url:current_url,tip:val.tip,state_code:val.state_code,mkt_ofc_cty_del_zne_id:val.mkt_ofc_cty_del_zne_id});});}temp={};_.each(tasks,function(val,key){_.each(val,function(vz,kz){tasks[key][kz].orders=_.sortBy(tasks[key][kz].orders,function(o){return o.timestamp;});});temp[key]=_.sortBy(tasks[key],function(o){return o.name;});});tasks=temp;_context8.next=20;return put(dashboardAction.listenSearchSuccess({count:result.tasks.length,tasks:tasks}));case 20:_context8.next=26;break;case 22:_context8.prev=22;_context8.t0=_context8[\"catch\"](0);notifyerror(_context8.t0.message);console.log(_context8.t0.message);case 26:case\"end\":return _context8.stop();}}},_marked8,null,[[0,22]]);}//Update filter\nexport function updateFilter(action){var url,data,payload,filterData,filterKeys,_data,states,zones,store;return _regeneratorRuntime.wrap(function updateFilter$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.prev=0;url='';url=\"tasks/filter\";data={filter:{key:'dashboard',value:JSON.stringify(action.data)}};_context9.next=6;return put(headerAction.syncFilter({key:'dashboard',value:action.data}));case 6:_context9.next=8;return call(callApiV2,'POST',url,data);case 8:payload=_context9.sent;// check for error    \nif(payload.data.error){//yield put(dashboardAction.listenSearchError());\n}// handle success result\nif(!payload.data){_context9.next=17;break;}//console.log('Filtered Saved')\nfilterData=action.data||{};filterKeys=filterData.filterKeys||{};_data={user_type:filterData.type,type:'default'};if(!isEmpty(filterKeys)){if(filterKeys.Store.length===0&&filterKeys.Area.length===0&&filterKeys.State.length>0){states=(filterKeys.State||[]).map(function(item){//return {state: item.value, zone_id: []};\nreturn item.value;});if(states.length>0){_data={type:'state',state:states};//value_one         =  'state';\n//value_two         =  states;\n}}if(filterKeys.Store.length===0&&filterKeys.Area.length>0){zones=[];(filterKeys.Area||[]).map(function(item){var index=zones.findIndex(function(z){return z.state===item.state;});//console.log(filterKeys.Area, index);\nif(index>-1){zones[index].zone_id.push(item.id);}else{zones.push({state:item.state,zone_id:[item.id]});}});if(zones.length>0){_data={type:'place',place:zones};//type         \t\t=  'place';\n//place         \t=  zones; \n}}if(filterKeys.Store.length>0){store=[];(filterKeys.Store||[]).forEach(function(item){store.push(item.store_id.toString());});if(store.length>0){_data={type:'store',store_id:store};//type         \t\t=  'store';\n//store_id         \t=  store;\n}}_data.user_type=filterData.type;if(!!!_data.type){_data.type='default';}}_context9.next=17;return put(dashboardAction.getShoppedLate(_data));case 17:_context9.next=23;break;case 19:_context9.prev=19;_context9.t0=_context9[\"catch\"](0);notifyerror(_context9.t0);console.log(_context9.t0.message);case 23:case\"end\":return _context9.stop();}}},_marked9,null,[[0,19]]);}//Get Search\nexport function getShoppedLate(action){var url,payload,result,shoppedLateSummary,states,zones,store;return _regeneratorRuntime.wrap(function getShoppedLate$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.prev=0;url='';url=\"tasks/summary\";_context10.next=5;return call(callApiV2,'POST',url,action.data);case 5:payload=_context10.sent;if(!payload.data.error){_context10.next=9;break;}_context10.next=9;return put(dashboardAction.listenShoppedLateError());case 9:if(!payload.data.result){_context10.next=15;break;}result=payload.data.result||[];shoppedLateSummary={};if(result.length>0){if(action.data.type==='default'){shoppedLateSummary=_objectSpread({},result[0]);}if(action.data.type==='state'){states={};result.map(function(item){states[item.state_code]={shopped_late:item.shopped_late,shopping_late_percent:item.shopping_late_percent,total_orders:item.total_orders};});shoppedLateSummary=_objectSpread({},states);}if(action.data.type==='place'){zones={};result.map(function(item){if(!!zones[item.state_code]){zones[item.state_code][item.mkt_ofc_cty_del_zne_id]={shopped_late:item.shopped_late,shopping_late_percent:item.shopping_late_percent,total_orders:item.total_orders};}else{zones[item.state_code]={};zones[item.state_code][item.mkt_ofc_cty_del_zne_id]={shopped_late:item.shopped_late,shopping_late_percent:item.shopping_late_percent,total_orders:item.total_orders};}});shoppedLateSummary=_objectSpread({},zones);}if(action.data.type==='store'){store={};result.map(function(item){store[item.store_id]={shopped_late:item.shopped_late,shopping_late_percent:item.shopping_late_percent,total_orders:item.total_orders};});shoppedLateSummary=_objectSpread({},store);}}//console.log(shoppedLateSummary);\n_context10.next=15;return put(dashboardAction.listenShoppedLateSuccess({summary:_objectSpread({},shoppedLateSummary),type:action.data.type}));case 15:_context10.next=21;break;case 17:_context10.prev=17;_context10.t0=_context10[\"catch\"](0);notifyerror(_context10.t0.message);console.log(_context10.t0.message);case 21:case\"end\":return _context10.stop();}}},_marked10,null,[[0,17]]);}export function watchDashboardStore(){return _regeneratorRuntime.wrap(function watchDashboardStore$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.prev=0;_context11.next=3;return takeEvery(dashboardConstant.GET_TRACK_DETAILS,getTrackDetails);case 3:_context11.next=5;return takeEvery(dashboardConstant.GET_TASK_DETAILS,getTaskDetails);case 5:_context11.next=7;return takeEvery(dashboardConstant.GET_LOCATIONS,getLocations);case 7:_context11.next=9;return takeEvery(dashboardConstant.DELETE_TASK,deleteTask);case 9:_context11.next=11;return takeEvery(dashboardConstant.UPDATE_TASK_STATUS,updateTaskStatus);case 11:_context11.next=13;return takeEvery(dashboardConstant.CREATE_TASK,createTask);case 13:_context11.next=15;return takeEvery(dashboardConstant.EDIT_TASK,editTask);case 15:_context11.next=17;return takeEvery(dashboardConstant.TASK_SEARCH,search);case 17:_context11.next=19;return takeEvery(dashboardConstant.UPDATE_FILTER,updateFilter);case 19:_context11.next=21;return takeEvery(dashboardConstant.GET_SHOPPEDLATE,getShoppedLate);case 21:_context11.next=26;break;case 23:_context11.prev=23;_context11.t0=_context11[\"catch\"](0);console.log(_context11.t0);case 26:case\"end\":return _context11.stop();}}},_marked11,null,[[0,23]]);}","map":{"version":3,"sources":["/home/biplab/Desktop/foodjets/src/containers/Dashboard/Saga/index.js"],"names":["getLocations","getTaskDetails","getTrackDetails","createTask","deleteTask","updateTaskStatus","editTask","search","updateFilter","getShoppedLate","watchDashboardStore","takeEvery","put","call","all","dashboardConstant","error","notifyerror","success","notifysuccess","dashboardAction","headerAction","callApi","callApiV2","callOnFleetApi","moment","_","isEmpty","compact","getDateTime","getSysDateTime","getFilter","action","url","statesLocalStorage","JSON","parse","localStorage","getItem","states","map","item","id","res","payload","zone","data","listenGetLocationsError","result","zoneList","taskType","pharmacy","locations","stores","user","user_type","v","k","value","label","address","store","zone_id","listenGetLocationsSuccess","zones","console","log","message","uuid","listenGetTaskDetailsError","listenGetTaskDetailsSuccess","listenCreateTaskError","listenCreateTaskSuccess","format","listenDeleteTaskError","listenDeleteTaskSuccess","orderStatus","status","listenUpdateTaskStatusError","listenUpdateTaskStatusSuccess","params","listenEditTaskError","listenEditTaskSuccess","response","cause","userType","valueOne","type","valueTwo","dateType","listenSearchError","tasks","length","val","key","recipient_sig","track_driver","current_url","tskStatus","driverStatus","dt","timeCreated","split","d","created_at","completeafter","completebefore","timezone","parseInt","completeAfter","completeBefore","completionDetails","events","onflt_recpnt_sig","pickup_onfleet_url","drop_onfleet_url","state_code","mkt_ofc_cty_del_zne_id","name","mkt_ofc_cty_del_zne_name","orders","push","complete_after","complete_before","recpnt_address","recipients","mrchnt_address","merchant","mrchnt_notes","notes","recpnt_notes","tsk_status","order_number","orderNumber","driver_name","mrchnt_location","location","recpnt_location","tip","temp","each","vz","kz","sortBy","o","timestamp","listenSearchSuccess","count","filter","stringify","syncFilter","filterData","filterKeys","Store","Area","State","state","index","findIndex","z","place","forEach","store_id","toString","listenShoppedLateError","shoppedLateSummary","shopped_late","shopping_late_percent","total_orders","listenShoppedLateSuccess","summary","GET_TRACK_DETAILS","GET_TASK_DETAILS","GET_LOCATIONS","DELETE_TASK","UPDATE_TASK_STATUS","CREATE_TASK","EDIT_TASK","TASK_SEARCH","UPDATE_FILTER","GET_SHOPPEDLATE"],"mappings":"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","sourcesContent":["import { takeEvery, put, call, all } from 'redux-saga/effects';\nimport * as dashboardConstant from '../constants';\nimport {error as notifyerror, success as notifysuccess} from '../../../util/notify';\nimport * as dashboardAction from '../actions';\nimport * as headerAction from '../../Header/actions';\nimport {callApi, callApiV2, callOnFleetApi} from '../../../Helper/api';\nimport moment from 'moment-timezone';\nimport * as _ from 'lodash';\nimport {isEmpty, compact} from 'lodash';\nimport { getDateTime, getSysDateTime, getFilter } from '../../../Helper/common';\n\n\n//Get Locations & Zones\nexport function* getLocations(action){\n    try {\n        let url                 =   '';\n        let statesLocalStorage  =   JSON.parse(localStorage.getItem('states') || '[]');\n        let states              =   statesLocalStorage.map(item => item.id);\n        url                     =   `location/all`;\n        const res   =   yield all([\n                                        call(callApi, 'GET', url),\n                                        call(callApiV2, 'POST', 'location/zones', {\"state\":states})\n                                    ]);\n\n        \n        if(res) {\n            let payload     =   res[0];\n            let zone        =   res[1];\n\n            // check for error    \n            if(payload.data.error){\n                yield put(dashboardAction.listenGetLocationsError());\n            }\n    \n            // handle success result\n            if(payload.data.result){\n                let zoneList    =   {};\n                let taskType    =   '';\n                let pharmacy    =   false;\n                let locations   =   [];\n                let stores      =   [];\n                let result      =   payload.data.result;\n                let user        =   payload.data.user;\n                if(user.user_type === 'pharmacy') {\n                    taskType    =   \"pharmacy\";\n                    pharmacy    =   true;\n                } else if(user.user_type === 'general'){\n                    taskType    =   \"general\";\n                    pharmacy    =   false;\n                } else { \n                    taskType    =   \"admin\";\n                    pharmacy    =   false;\n                }\n                result.map((v, k) => {\n                    locations[k] = {\n                        id      :   v.id,\n                        value   :   k,\n                        label   :   v.address,\n                        data    :   v\n                    };\t\n                    if(v.store !== '' && v.store !== null) {\n                        stores[k] = {\n                            id      :   v.id,\n                            zone_id :   v.zone_id,\n                            value   :   k,\n                            label   :   v.store,\n                            data    :   v\n                        };\n                    }\n                });\n                stores          =   compact(stores);\n                locations       =   compact(locations);\n\n                if(!!zone.data) {\n                    zoneList            =   zone.data || {};\n                }\n\n                yield put(dashboardAction.listenGetLocationsSuccess({\n                    taskType: taskType,\n                    pharmacy: pharmacy,\n                    locations: locations,\n                    stores: stores,\n                    zones: zoneList\n                }));\n            }\n        }\n    } catch (e) {\n        notifyerror(e);\n        console.log(e.message);\n    }\n}\n\n\n//Get Locations & Zones\nexport function* getTaskDetails(action){\n    try {\n        let url                 =   '';\n        url                     =   `tasks/${action.data.uuid}`;\n        const payload               =   yield call(callApiV2, 'GET', url);       \n\n        // check for error    \n        if(payload.data.error){\n            yield put(dashboardAction.listenGetTaskDetailsError());\n        }\n\n        // handle success result\n        if(payload.data){ \n            yield put(dashboardAction.listenGetTaskDetailsSuccess(payload.data));\n        }\n    } catch (e) {\n        notifyerror(e.message);\n        console.log(e.message);\n    }\n}\n\n//Get Track Details\nexport function* getTrackDetails(action){\n    try {\n        let url                 =   '';\n        url                     =   `tasks/${action.data.uuid}`;\n        const payload               =   yield call(callOnFleetApi, 'GET', url);       \n\n        // check for error    \n        if(payload.data.error){\n            //yield put(dashboardAction.listenGetTaskDetailsError());\n        }\n\n        // handle success result\n        if(payload.data){\n            //yield put(dashboardAction.listenGetTaskDetailsSuccess(payload.data));\n        }\n    } catch (e) {\n        notifyerror(e.message);\n        console.log(e.message);\n    }\n}\n\n//Create Task\nexport function* createTask(action){\n    try {\n        let url             =   '';\n        url                 =   `tasks`;\n        const payload       =   yield call(callApi, 'POST', url, action.data);\n\n        // check for error\n        if(payload.data.error){\n            console.log(payload.data.error);\n            yield put(dashboardAction.listenCreateTaskError());\n        }\n\n        // handle success result\n        if(payload.data){           \n            notifysuccess({message: 'Task has been created successfully'});    \n            yield put(dashboardAction.listenCreateTaskSuccess({}));\n        }\n    } catch (e) {\n        notifyerror(e.message);\n        console.log(e.message);\n    }\n}\n\n//Delete Task\nexport function* deleteTask(action){\n    try {\n        let url             =   '';\n        url                 =   `tasks/${action.data.uuid}`;\n        let data            =   {\"timestamp\":moment().format('X')}\n        const payload       =   yield call(callApi, 'DELETE', url, data);  \n\n        // check for error\n        if(payload.data.error){\n            yield put(dashboardAction.listenDeleteTaskError());\n        }\n\n        // handle success result\n        if(payload.data){           \n            notifysuccess({message: 'Task deleted successfully'});\n            yield put(dashboardAction.listenDeleteTaskSuccess({}));\n        }\n    } catch (e) {\n        notifyerror(e.message);\n        console.log(e.message);\n    }\n}\n\n//Update Task Status\nexport function* updateTaskStatus(action){\n    try {\n        let url             =   '';\n        url                 =   `tasks/status/${action.data.uuid}`;\n        let data            =   {orderStatus:{status:action.data.status}};\n        const payload       =   yield call(callApi, 'PUT', url, data);  \n\n        // check for error\n        if(payload.data.error){\n            yield put(dashboardAction.listenUpdateTaskStatusError());\n        }\n\n        // handle success result\n        if(payload.data){\n            notifysuccess({message: 'Task status updated successfully'});           \n            yield put(dashboardAction.listenUpdateTaskStatusSuccess({}));\n        }\n    } catch (e) {\n        notifyerror(e.message);\n        console.log(e.message);\n    }\n}\n\n//Edit Task\nexport function* editTask(action){\n    try {\n        let url             =   '';\n        url                 =   `tasks/${action.data.uuid}`;\n        let data            =   {...action.data.params};\n        const payload       =   yield call(callApi, 'PUT', url, data);  \n\n        // check for error\n        if(payload.data.error){\n            yield put(dashboardAction.listenEditTaskError());\n        }\n\n        // handle success result\n        if(payload.data){\n            //console.log('Success : ', payload.data);\n            notifysuccess({message: 'Task updated successfully'});           \n            yield put(dashboardAction.listenEditTaskSuccess({}));\n        }\n    } catch (e) {\n        //console.log('Catch : ', e, e.response, e.response.data, e.message.cause);\n        if(e.response && !!e.response.data) {\n            notifyerror({message: e.response.data.message.cause});\n        } else {\n            notifyerror({message: e.message});\n        }\n        console.log(e.message);\n    }\n}\n\n//Get Search\nexport function* search(action){\n    try {\n        let url                 =   '';\n        url                     =   `tasks/search`;\n        let data                =   {\n            userType    :   action.data.user_type,\n            valueOne    :   action.data.type,\n            valueTwo    :   action.data.value\n        }\n        if(!!action.data.dateType) {\n            data.dateType        =   action.data.dateType;\n        }\n        const payload            =   yield call(callApiV2, 'POST', url, data);\n\n        // check for error    \n        if(payload.data.error){\n            yield put(dashboardAction.listenSearchError());\n        }\n\n        // handle success result\n        if(payload.data.result){\n            let result = payload.data.result;\n            let tasks = {};\n            if(result.tasks.length > 0) {\n                result.tasks.map((val, key) => {\n                    let recipient_sig   =   false;                    \n                    let track_driver    =   '';\n                    let current_url     =   '';\n                    let tskStatus       =   'Scheduled';\n                    if(val.tskStatus === 'tsk_proc_hld') {\n                        tskStatus       =   'Scheduled'\n                    } else if(val.tskStatus === 'tsk_proc_mrchnt') {\n                        tskStatus       =   'Scheduled'\n                    } else if(val.tskStatus === 'tsk_proc_drv' && val.driverStatus === 'drv_strt_recpnt_tsk') {\n                        tskStatus       =   'Picked Up';\n                    } else if(val.tskStatus === 'tsk_proc_drv') {\n                        tskStatus       =   'Processing'\n                    } else if(val.tskStatus === 'tsk_cmp') {\n                        tskStatus       =   'Completed'\n                    } else if(val.tskStatus === 'tsk_cncling') {\n                        tskStatus       =   'Deleted'\n                    } else if(val.tskStatus === 'tsk_cncled') {\n                        tskStatus       =   'Deleted'\n                    }\n                    let dt              =   val.timeCreated.split('T');\n                    let d               =   dt[0].split('-');\n                    let created_at      =   d[1]+'/'+d[2]+'/'+d[0]; \n                    \n                    let completeafter   =   '';\n                    let completebefore  =   '';\n                    \n                    if(val.timezone !== '') {\n                        completeafter   =   getDateTime(parseInt(val.completeAfter) * 1000, val.timezone, 'MM/DD 路 hh:mma');\n                        completebefore  =   getDateTime(parseInt(val.completeBefore) * 1000, val.timezone, 'hh:mma');\n                    } else {\n                    completeafter       =   getSysDateTime(parseInt(val.completeAfter) * 1000, 'MM/DD 路 hh:mma');\n                    completebefore      =   getSysDateTime(parseInt(val.completeBefore) * 1000, 'hh:mma');\n                    }\n                    if(!isEmpty(val.completionDetails.events) && \n                        !!val.completionDetails.events.onflt_recpnt_sig) {\n                        recipient_sig   =   true;\n                    }\n                    if(!isEmpty(val.completionDetails.events) && \n                        !!val.completionDetails.events.onflt_recpnt_sig) {\n                        recipient_sig   =   true;\n                    }\n\n                    if(!!val.pickup_onfleet_url) {\n                        track_driver    =   'Driver to Merchant';\n                        current_url     =   val.pickup_onfleet_url;\n                    }\n                    \n                    if(!!val.drop_onfleet_url) {\n                        track_driver    =   'Driver to Recipient';\n                        current_url     =   val.drop_onfleet_url;\n                    }\n\n                    if(!!!tasks[val.state_code]) {\n                        tasks[val.state_code]   =   {};\n                        tasks[val.state_code][val.mkt_ofc_cty_del_zne_id]   =   {\n                            name        :   val.mkt_ofc_cty_del_zne_name,\n                            id          :   val.state_code+val.mkt_ofc_cty_del_zne_id,\n                            orders      :   []\n                        };\n                    } else {\n                        if(!!!tasks[val.state_code][val.mkt_ofc_cty_del_zne_id]) {\n                            tasks[val.state_code][val.mkt_ofc_cty_del_zne_id]   =   {\n                                name        :   val.mkt_ofc_cty_del_zne_name,\n                                id          :   val.state_code+val.mkt_ofc_cty_del_zne_id,\n                                orders      :   []\n                            };\n                        }\n                    }\n                    \n                    tasks[val.state_code][val.mkt_ofc_cty_del_zne_id].orders.push({\n                        created_at              :   created_at,\n                        complete_after          :   completeafter,\n                        complete_before         :   completebefore,\n                        recpnt_address          :   val.recipients.address,\n                        mrchnt_address          :   val.merchant.address,\n                        mrchnt_notes            :   val.merchant.notes,\n                        recpnt_notes            :   val.recipients.notes,\n                        tsk_status              :   tskStatus,\n                        uuid                    :   val.uuid,\n                        order_number            :   val.orderNumber,\n                        driver_name             :   val.driver_name,\n                        recipient_sig           :   recipient_sig,\n                        timezone                :   val.timezone,\n                        mrchnt_location         :   val.merchant.location,\n                        recpnt_location         :   val.recipients.location,\n                        drop_onfleet_url        :   val.drop_onfleet_url || '',\n                        pickup_onfleet_url      :   val.pickup_onfleet_url || '',\n                        track_driver            :   track_driver,\n                        current_url             :   current_url,\n                        tip                     :   val.tip,\n                        state_code              :   val.state_code,\n                        mkt_ofc_cty_del_zne_id  :   val.mkt_ofc_cty_del_zne_id\n                    });\n                });\n            }\n            let temp                        =   {};\n            _.each(tasks, (val, key) => {\n                _.each(val, (vz, kz) => {\n                    tasks[key][kz].orders   =   _.sortBy(tasks[key][kz].orders, (o) => { return o.timestamp; })\n                });\n                temp[key]                   =   _.sortBy(tasks[key], (o) => { return o.name; })\n            });\n            tasks                           =   temp;\n            yield put(dashboardAction.listenSearchSuccess({count: result.tasks.length, tasks: tasks}));\n        }\n    } catch (e) {\n        notifyerror(e.message);\n        console.log(e.message);\n    }\n}\n\n//Update filter\nexport function* updateFilter(action){\n    try {\n        let url                 =   '';\n        url                     =   `tasks/filter`;\n        let data                =   {\n            filter: {\n                key : 'dashboard',\n                value : JSON.stringify(action.data)\n            }\n        }\n        yield put(headerAction.syncFilter({\n            key : 'dashboard',\n            value : action.data\n        }));\n        const payload            =   yield call(callApiV2, 'POST', url, data);\n\n        // check for error    \n        if(payload.data.error){\n            //yield put(dashboardAction.listenSearchError());\n        }\n\n        // handle success result\n        if(payload.data){\n            //console.log('Filtered Saved')\n            let filterData      =  action.data || {};\n            let filterKeys      =  filterData.filterKeys || {};\n            let data            =\t{\n                user_type\t\t:\tfilterData.type,\n                type            :   'default'\n            }\n            if(!isEmpty(filterKeys)) {   \n                if(filterKeys.Store.length === 0 && filterKeys.Area.length === 0 && filterKeys.State.length > 0) {\n                    let states           =  (filterKeys.State || []).map(item => {\n                    //return {state: item.value, zone_id: []};\n                    return item.value;\n                    });\n                    if(states.length > 0){\n                        data\t\t\t=\t{\n                            type\t\t:\t'state',\n                            state\t\t:\tstates\n                        }\n                    //value_one         =  'state';\n                    //value_two         =  states;\n                    }\n                }\n        \n                if(filterKeys.Store.length === 0 && filterKeys.Area.length > 0) {         \n                    let zones           =  [];\n                    (filterKeys.Area || []).map((item) => {\n                    let index\t\t=\tzones.findIndex((z) => z.state === item.state);\n                    //console.log(filterKeys.Area, index);\n                    if(index > -1){\n                        zones[index].zone_id.push(item.id)\n                    } else {\n                        zones.push({\n                            state: item.state,\n                            zone_id : [item.id]\n                        })\n                    }\n                    });\n\n                    if(zones.length > 0){\n                    data\t\t\t=\t{\n                        type\t\t:\t'place',\n                        place\t\t:\tzones\n                    }\n                    //type         \t\t=  'place';\n                    //place         \t=  zones; \n                    \n                    }\n                }\n        \n                if(filterKeys.Store.length > 0) {\n                    let store            =  [];\n                    (filterKeys.Store || []).forEach(item => {\n                    store.push(item.store_id.toString());\n                    })\n                    if(store.length > 0){\n                    data\t\t\t=\t{\n                        type\t\t:\t'store',\n                        store_id\t:\tstore\n                    }\n                    //type         \t\t=  'store';\n                    //store_id         \t=  store;\n                    }\n                }\n                data.user_type\t\t=\tfilterData.type;\n                if(!!!data.type) {\n                    data.type      =  'default';\n                }\n            }\n            yield put(dashboardAction.getShoppedLate(data));\n        }\n    } catch (e) {\n        notifyerror(e);\n        console.log(e.message);\n    }\n}\n\n\n\n//Get Search\nexport function* getShoppedLate(action){\n    try {\n        let url                 =   '';\n        url                     =   `tasks/summary`;\n        const payload            =   yield call(callApiV2, 'POST', url, action.data);\n\n        // check for error    \n        if(payload.data.error){\n            yield put(dashboardAction.listenShoppedLateError());\n        }\n\n        // handle success result\n        if(payload.data.result){\n            let result                  =   payload.data.result || [];\n            let shoppedLateSummary      =   {};\n            if(result.length > 0) {\n                if(action.data.type === 'default') {\n                    shoppedLateSummary      =   {...result[0]};\n                }\n                if(action.data.type === 'state') {\n                    let states          =   {};\n                    result.map(item => {\n                        states[item.state_code]     =   {\n                            shopped_late:   item.shopped_late,\n                            shopping_late_percent: item.shopping_late_percent,\n                            total_orders: item.total_orders\n                        }\n                    })\n                    shoppedLateSummary      =   {...states};\n                }\n                if(action.data.type === 'place') {\n                    let zones          =   {};\n                    result.map(item => {\n                        if(!!zones[item.state_code]) {                            \n                            zones[item.state_code][item.mkt_ofc_cty_del_zne_id]     =   {\n                                shopped_late:   item.shopped_late,\n                                shopping_late_percent: item.shopping_late_percent,\n                                total_orders: item.total_orders\n                            }\n                        } else {\n                            zones[item.state_code]   =   {};\n                            zones[item.state_code][item.mkt_ofc_cty_del_zne_id]     =   {\n                                shopped_late:   item.shopped_late,\n                                shopping_late_percent: item.shopping_late_percent,\n                                total_orders: item.total_orders\n                            }\n                        }\n                    })\n                    shoppedLateSummary      =   {...zones};\n                }\n                if(action.data.type === 'store') {\n                    let store          =   {};\n                    result.map(item => {\n                        store[item.store_id]     =   {\n                            shopped_late:   item.shopped_late,\n                            shopping_late_percent: item.shopping_late_percent,\n                            total_orders: item.total_orders\n                        }\n                    })\n                    shoppedLateSummary      =   {...store};\n                }\n            }\n            //console.log(shoppedLateSummary);\n            yield put(dashboardAction.listenShoppedLateSuccess({summary: {...shoppedLateSummary}, type: action.data.type}));\n        }\n    } catch (e) {\n        notifyerror(e.message);\n        console.log(e.message);\n    }\n}\n\nexport function* watchDashboardStore() {\n    try{\n        yield takeEvery( dashboardConstant.GET_TRACK_DETAILS, getTrackDetails );\n        yield takeEvery( dashboardConstant.GET_TASK_DETAILS, getTaskDetails );\n        yield takeEvery( dashboardConstant.GET_LOCATIONS, getLocations );\n        yield takeEvery( dashboardConstant.DELETE_TASK, deleteTask );\n        yield takeEvery( dashboardConstant.UPDATE_TASK_STATUS, updateTaskStatus );\n        yield takeEvery( dashboardConstant.CREATE_TASK, createTask );\n        yield takeEvery( dashboardConstant.EDIT_TASK, editTask );\n        yield takeEvery( dashboardConstant.TASK_SEARCH, search );\n        yield takeEvery( dashboardConstant.UPDATE_FILTER, updateFilter );\n        yield takeEvery( dashboardConstant.GET_SHOPPEDLATE, getShoppedLate );\n    } catch(e){\n        console.log(e)\n    }\n}"]},"metadata":{},"sourceType":"module"}