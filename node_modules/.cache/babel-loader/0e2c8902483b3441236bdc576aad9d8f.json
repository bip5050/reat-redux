{"ast":null,"code":"import _regeneratorRuntime from\"/home/biplab/Desktop/foodjets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/biplab/Desktop/foodjets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(getReport),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(getOrder),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(getLateOrders),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(sortLateOrders),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(watchReportStore);import*as reportAction from'../actions';import*as headerAction from'../../Header/actions';import*as reportConstant from'../constants';import{callApiV2}from'../../../Helper/api';import{takeEvery,put,call,all}from'redux-saga/effects';import{error as notifyerror,success as notifysuccess}from'../../../util/notify';import{convertTwoDecimalRound,getDateTime,getSysDateTime,formatDate}from'../../../Helper/common';import moment from'moment-timezone';import*as _ from'lodash';//Get Reports\nexport function getReport(action){var data,statsData,reportData,res,rerun,orders,statsTotal,rerunData,reportTotal;return _regeneratorRuntime.wrap(function getReport$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;data=_objectSpread({},action.data);delete data.show_by;statsData=_objectSpread({},data);delete data.filter;delete action.data.filter;reportData=_objectSpread({},action.data);if(reportData.show_by==='month'){reportData.start=moment().subtract(12,'months').format('YYYY-MM-DD');reportData.end=moment().format('YYYY-MM-DD');}_context.next=10;return put(headerAction.syncFilter({key:statsData.filter.key,value:JSON.parse(statsData.filter.value)}));case 10:_context.next=12;return all([call(callApiV2,'POST','reports/rerun',data),call(callApiV2,'POST','reports/orders',reportData),call(callApiV2,'POST','reports/stats-total',statsData)]);case 12:res=_context.sent;if(!res){_context.next=35;break;}rerun=res[0];orders=res[1];statsTotal=res[2];// check for error    \nif(!(rerun.data.error||rerun.data.error||rerun.data.error)){_context.next=20;break;}_context.next=20;return put(reportAction.listenGetReportError());case 20:;if(!rerun.data.result){_context.next=32;break;}rerunData=rerun.data.result;rerunData.chng_rerun_total_percent=convertTwoDecimalRound(rerunData.chng_rerun_total_percent);reportTotal=statsTotal.data.result;reportTotal.chng_shopping_late_percent=convertTwoDecimalRound(reportTotal.chng_shopping_late_percent);reportTotal.chng_tot_orders_percent=convertTwoDecimalRound(reportTotal.chng_tot_orders_percent);reportTotal.late_percentage=convertTwoDecimalRound(reportTotal.late_percentage);reportTotal.on_time_percentage=convertTwoDecimalRound(reportTotal.on_time_percentage);reportTotal.shopping_late_percent=convertTwoDecimalRound(reportTotal.shopping_late_percent);//console.log(rerunData, reportTotal);\n_context.next=32;return put(reportAction.listenGetReportSuccess({rerunData:rerunData,ordersData:orders.data.result,reportTotal:reportTotal}));case 32:;_context.next=36;break;case 35:notifyerror({message:\"Some error occured.\"});case 36:_context.next=42;break;case 38:_context.prev=38;_context.t0=_context[\"catch\"](0);notifyerror(_context.t0);console.log(_context.t0.message);case 42:case\"end\":return _context.stop();}}},_marked,null,[[0,38]]);};//Get Daily/Store/Monthly Orders\nexport function getOrder(action){var data,payload;return _regeneratorRuntime.wrap(function getOrder$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:data=_objectSpread({},action.data);if(data.show_by==='month'){data.start=moment().subtract(12,'months').format('YYYY-MM-DD');data.end=moment().format('YYYY-MM-DD');}_context2.prev=2;_context2.next=5;return call(callApiV2,'POST','reports/orders',data);case 5:payload=_context2.sent;if(!payload.data.error){_context2.next=9;break;}_context2.next=9;return put(reportAction.listenGetOrderError());case 9:;if(!payload.data.result){_context2.next=13;break;}_context2.next=13;return put(reportAction.listenGetOrderSuccess(payload.data.result));case 13:;_context2.next=20;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](2);notifyerror(_context2.t0);console.log(_context2.t0.message);case 20:case\"end\":return _context2.stop();}}},_marked2,null,[[2,16]]);};//Get Late Orders\nexport function getLateOrders(action){var data,payload,response,sortData;return _regeneratorRuntime.wrap(function getLateOrders$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;data=_objectSpread({},action.data);delete data.filter;data.order_by='complete_after';//console.log(data);\n//delete data.format;\n_context3.next=6;return call(callApiV2,'POST',\"reports/late-orders\",data);case 6:payload=_context3.sent;if(!payload.data.error){_context3.next=10;break;}_context3.next=10;return put(reportAction.listenLateOrders());case 10:;if(!payload.data.result){_context3.next=16;break;}//console.log(payload.data.result);\n//console.log('Length : ', result.tasks.length);\nresponse=payload.data.result||{};//sortLateOrders(response, action, order_by, order, filterState, filterArea, filterStore, data);\nsortData={unsortedLateOrders:response.data,count:response.count,searchData:action.data};_context3.next=16;return put(reportAction.sortLateOrders(sortData));case 16:;_context3.next=23;break;case 19:_context3.prev=19;_context3.t0=_context3[\"catch\"](0);notifyerror(_context3.t0);console.log(_context3.t0.message);case 23:case\"end\":return _context3.stop();}}},_marked3,null,[[0,19]]);};function sortLateOrders(action){var data,filter,filterState,filterArea,filterStore,order_by,order,result,tasks,count,listType,temp,_temp;return _regeneratorRuntime.wrap(function sortLateOrders$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:data=action.data.searchData;//console.log('Action Data : ', data);\nfilter=data.filter||{};filterState=filter.filterKeys.State||[];filterArea=filter.filterKeys.Area||[];filterStore=filter.filterKeys.Store||[];order_by=data.order_by||'complete_after';order=data.format||'asc';result=action.data.unsortedLateOrders;tasks={};count=action.data.count||0;listType='';if(data.type==='store'){listType='Zonewise';if(result.length>0){result.map(function(val,key){//count++;\nif(!!!tasks[val.state_code]){tasks[val.state_code]={};tasks[val.state_code][val.store_id]={name:val.store,id:val.store_id,orders:[],a:0,b:0,c:0,d:0,total:0};}else{if(!!!tasks[val.state_code][val.store_id]){tasks[val.state_code][val.store_id]={name:val.store,id:val.store_id,orders:[],a:0,b:0,c:0,d:0,total:0};}}tasks[val.state_code][val.store_id].total++;var lateClass='';if(val.time_diff>=0&&val.time_diff<=20){lateClass='ready';tasks[val.state_code][val.store_id].b++;}else if(val.time_diff>20&&val.time_diff<=30){lateClass='shopping';tasks[val.state_code][val.store_id].c++;}else if(val.time_diff>30){lateClass='not_ready';tasks[val.state_code][val.store_id].d++;}else{tasks[val.state_code][val.store_id].a++;}tasks[val.state_code][val.store_id].orders.push({timestamp:moment(val.created_at).format('X'),created_at:formatDate(val.created_at),cust_name:val.cust_name.toLowerCase(),customer_name:val.cust_name,order_number:val.order_number,store:val.store,store_id:val.store_id,complete_before:formatDate(val.complete_before),complete_after:formatDate(val.complete_after),delivery_time:formatDate(val.delivery_time),driver_wait:val.driver_wait,recpnt_task_start_time:formatDate(val.recpnt_task_start_time),lateClass:lateClass,time_diff:val.time_diff,uuid:val.uuid});});}temp={};_.each(tasks,function(val,key){_.each(val,function(vz,kz){tasks[key][kz].orders=_.orderBy(tasks[key][kz].orders,[function(o){return o[order_by];}],[order]);});temp[key]=_.sortBy(tasks[key],function(o){return o.store;});});tasks=temp;}else if(data.type==='place'){if(filterState.length>0&&filterArea.length===0){listType='Statewise';if(result.length>0){result.map(function(val,key){//count++;\nif(!!!tasks[val.state_code]){tasks[val.state_code]={name:val.state_code,orders:[],a:0,b:0,c:0,d:0,total:0};}tasks[val.state_code].total++;var lateClass='';if(val.time_diff>=0&&val.time_diff<=20){lateClass='ready';tasks[val.state_code].b++;}else if(val.time_diff>20&&val.time_diff<=30){lateClass='shopping';tasks[val.state_code].c++;}else if(val.time_diff>30){lateClass='not_ready';tasks[val.state_code].d++;}else{tasks[val.state_code].a++;}//console.log(tasks[val.state_code]);\ntasks[val.state_code].orders.push({timestamp:moment(val.created_at).format('X'),created_at:formatDate(val.created_at),cust_name:val.cust_name.toLowerCase(),customer_name:val.cust_name,order_number:val.order_number,store:val.store,store_id:val.store_id,complete_before:formatDate(val.complete_before),complete_after:formatDate(val.complete_after),delivery_time:formatDate(val.delivery_time),driver_wait:val.driver_wait,recpnt_task_start_time:formatDate(val.recpnt_task_start_time),lateClass:lateClass,time_diff:val.time_diff,uuid:val.uuid});});}_.each(tasks,function(val,key){tasks[key].orders=_.orderBy(tasks[key].orders,[function(o){return o[order_by];}],[order]);});}else if(filterArea.length>0){listType='Zonewise';if(result.length>0){result.map(function(val,key){//count++;\nif(!!!tasks[val.state_code]){tasks[val.state_code]={};tasks[val.state_code][val.zone_id]={name:val.zone_name,id:val.zone_id,orders:[],a:0,b:0,c:0,d:0,total:0};}else{if(!!!tasks[val.state_code][val.zone_id]){tasks[val.state_code][val.zone_id]={name:val.zone_name,id:val.zone_id,orders:[],a:0,b:0,c:0,d:0,total:0};}}var lateClass='';tasks[val.state_code][val.zone_id].total++;if(val.time_diff>=0&&val.time_diff<=20){tasks[val.state_code][val.zone_id].b++;lateClass='ready';}else if(val.time_diff>20&&val.time_diff<=30){tasks[val.state_code][val.zone_id].c++;lateClass='shopping';}else if(val.time_diff>30){tasks[val.state_code][val.zone_id].d++;lateClass='not_ready';}else{tasks[val.state_code][val.zone_id].a++;}tasks[val.state_code][val.zone_id].orders.push({timestamp:moment(val.created_at).format('X'),created_at:formatDate(val.created_at),cust_name:val.cust_name.toLowerCase(),customer_name:val.cust_name,order_number:val.order_number,store:val.store,store_id:val.store_id,complete_before:formatDate(val.complete_before),complete_after:formatDate(val.complete_after),delivery_time:formatDate(val.delivery_time),driver_wait:val.driver_wait,recpnt_task_start_time:formatDate(val.recpnt_task_start_time),lateClass:lateClass,time_diff:val.time_diff,uuid:val.uuid});});}_temp={};_.each(tasks,function(val,key){_.each(val,function(vz,kz){//tasks[key][kz].orders   =   _.orderBy(tasks[key][kz].orders, [o => o.timestamp], ['desc'])\ntasks[key][kz].orders=_.orderBy(tasks[key][kz].orders,[function(o){return o[order_by];}],[order]);});_temp[key]=_.sortBy(tasks[key],function(o){return o.zone_name;});});tasks=_temp;}}else{tasks={a:0,b:0,c:0,d:0,total:0,orders:[]};listType='Uncategorized';result.map(function(val,key){//count++;\ntasks.total++;var lateClass='';if(val.time_diff>=0&&val.time_diff<=20){tasks.b++;lateClass='ready';}else if(val.time_diff>20&&val.time_diff<=30){lateClass='shopping';tasks.c++;}else if(val.time_diff>30){lateClass='not_ready';tasks.d++;}else{tasks.a++;}//console.log(val.time_diff, moment(val.time_diff).format(\"mm:ss\"))   \ntasks.orders.push({timestamp:moment(val.created_at).format('X'),created_at:formatDate(val.created_at),cust_name:val.cust_name.toLowerCase(),customer_name:val.cust_name,order_number:val.order_number,store:val.store,store_id:val.store_id,complete_before:formatDate(val.complete_before),complete_after:formatDate(val.complete_after),delivery_time:formatDate(val.delivery_time),driver_wait:val.driver_wait,recpnt_task_start_time:formatDate(val.recpnt_task_start_time),lateClass:lateClass,time_diff:val.time_diff,uuid:val.uuid});});//tasks                           =   result.tasks || [];\ntasks.orders=_.orderBy(tasks.orders,[function(o){return o[order_by];}],[order]);}//console.log('Saga : ', {count: count, tasks: tasks, listType: listType});\n_context4.next=14;return put(reportAction.listenLateOrdersSuccess({unsortedLateOrders:result,arrangedTasks:{count:count,tasks:tasks,listType:listType,pageno:data.page,sortBy:order_by,format:order}}));case 14:case\"end\":return _context4.stop();}}},_marked4);}export function watchReportStore(){return _regeneratorRuntime.wrap(function watchReportStore$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return takeEvery(reportConstant.GET_REPORT,getReport);case 3:_context5.next=5;return takeEvery(reportConstant.GET_ORDER,getOrder);case 5:_context5.next=7;return takeEvery(reportConstant.GET_LATE_ORDER,getLateOrders);case 7:_context5.next=9;return takeEvery(reportConstant.SORT_LATE_ORDERS,sortLateOrders);case 9:_context5.next=14;break;case 11:_context5.prev=11;_context5.t0=_context5[\"catch\"](0);console.log(_context5.t0);case 14:case\"end\":return _context5.stop();}}},_marked5,null,[[0,11]]);};","map":{"version":3,"sources":["/home/biplab/Desktop/foodjets/src/containers/Reports/Saga/index.js"],"names":["getReport","getOrder","getLateOrders","sortLateOrders","watchReportStore","reportAction","headerAction","reportConstant","callApiV2","takeEvery","put","call","all","error","notifyerror","success","notifysuccess","convertTwoDecimalRound","getDateTime","getSysDateTime","formatDate","moment","_","action","data","show_by","statsData","filter","reportData","start","subtract","format","end","syncFilter","key","value","JSON","parse","res","rerun","orders","statsTotal","listenGetReportError","result","rerunData","chng_rerun_total_percent","reportTotal","chng_shopping_late_percent","chng_tot_orders_percent","late_percentage","on_time_percentage","shopping_late_percent","listenGetReportSuccess","ordersData","message","console","log","payload","listenGetOrderError","listenGetOrderSuccess","order_by","listenLateOrders","response","sortData","unsortedLateOrders","count","searchData","filterState","filterKeys","State","filterArea","Area","filterStore","Store","order","tasks","listType","type","length","map","val","state_code","store_id","name","store","id","a","b","c","d","total","lateClass","time_diff","push","timestamp","created_at","cust_name","toLowerCase","customer_name","order_number","complete_before","complete_after","delivery_time","driver_wait","recpnt_task_start_time","uuid","temp","each","vz","kz","orderBy","o","sortBy","zone_id","zone_name","listenLateOrdersSuccess","arrangedTasks","pageno","page","GET_REPORT","GET_ORDER","GET_LATE_ORDER","SORT_LATE_ORDERS"],"mappings":"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","sourcesContent":["import * as reportAction from '../actions';\nimport * as headerAction from '../../Header/actions';\nimport * as reportConstant from '../constants';\nimport {callApiV2} from '../../../Helper/api';\nimport { takeEvery, put, call, all } from 'redux-saga/effects';\nimport {error as notifyerror, success as notifysuccess} from '../../../util/notify';\nimport {convertTwoDecimalRound, getDateTime, getSysDateTime, formatDate} from '../../../Helper/common';\nimport moment from 'moment-timezone';\nimport * as _ from 'lodash';\n\n//Get Reports\nexport function* getReport(action){\n    try {\n        let data        =   {...action.data};\n        delete data.show_by;\n        let statsData       =   {...data};\n        delete data.filter;\n        delete action.data.filter;\n        let reportData      =   {...action.data};\n        if(reportData.show_by === 'month') {\n            reportData.start       =   moment().subtract(12, 'months').format('YYYY-MM-DD');\n            reportData.end         =   moment().format('YYYY-MM-DD');\n        }\n        yield put(headerAction.syncFilter({key: statsData.filter.key, value: JSON.parse(statsData.filter.value)}));\n        const res = yield all([\n            call(callApiV2, 'POST', 'reports/rerun', data),\n            call(callApiV2, 'POST', 'reports/orders', reportData),\n            call(callApiV2, 'POST', 'reports/stats-total', statsData)\n        ]);\n\n        if(res) {\n            let rerun = res[0];\n            let orders = res[1];\n            let statsTotal = res[2];\n\n            // check for error    \n            if(rerun.data.error || rerun.data.error || rerun.data.error){\n                yield put(reportAction.listenGetReportError());\n            };\n\n            if(rerun.data.result){\n                let rerunData       =   rerun.data.result;\n                rerunData.chng_rerun_total_percent  =   convertTwoDecimalRound(rerunData.chng_rerun_total_percent);\n\n                let reportTotal     =   statsTotal.data.result;\n                reportTotal.chng_shopping_late_percent  =   convertTwoDecimalRound(reportTotal.chng_shopping_late_percent);\n                reportTotal.chng_tot_orders_percent  =   convertTwoDecimalRound(reportTotal.chng_tot_orders_percent);\n                reportTotal.late_percentage  =   convertTwoDecimalRound(reportTotal.late_percentage);\n                reportTotal.on_time_percentage  =   convertTwoDecimalRound(reportTotal.on_time_percentage);\n                reportTotal.shopping_late_percent  =   convertTwoDecimalRound(reportTotal.shopping_late_percent);\n\n                //console.log(rerunData, reportTotal);\n                yield put(reportAction.listenGetReportSuccess({\n                    rerunData: rerunData,\n                    ordersData: orders.data.result,\n                    reportTotal: reportTotal\n                }));\n            };\n        } else {\n            notifyerror({message: \"Some error occured.\"}); \n        }\n    } catch (e) {\n        notifyerror(e);\n        console.log(e.message);\n    }\n};\n\n\n//Get Daily/Store/Monthly Orders\nexport function* getOrder(action){\n    let data                    =   {...action.data};\n    if(data.show_by === 'month') {\n        data.start       =   moment().subtract(12, 'months').format('YYYY-MM-DD');\n        data.end         =   moment().format('YYYY-MM-DD');\n    }\n    try {\n        const payload = yield call(callApiV2, 'POST', 'reports/orders', data);\n\n        // check for error    \n        if(payload.data.error){\n            yield put(reportAction.listenGetOrderError());\n        };\n\n        if(payload.data.result){\n            yield put(reportAction.listenGetOrderSuccess(payload.data.result));\n        };\n    } catch (e) {\n        notifyerror(e);\n        console.log(e.message);\n    }\n};\n\n//Get Late Orders\nexport function* getLateOrders(action){\n    try {\n        let data        =   {...action.data};\n        delete data.filter;\n        data.order_by   =   'complete_after';\n        //console.log(data);\n        //delete data.format;\n        const payload = yield call(callApiV2, 'POST', `reports/late-orders`, data);\n\n        // check for error\n        if(payload.data.error){\n            yield put(reportAction.listenLateOrders());\n        };\n\n        if(payload.data.result){\n            //console.log(payload.data.result);\n            //console.log('Length : ', result.tasks.length);\n            let response    =   payload.data.result || {};\n            //sortLateOrders(response, action, order_by, order, filterState, filterArea, filterStore, data);\n            let sortData    =   {\n                unsortedLateOrders    :   response.data,\n                count       :   response.count,\n                searchData  :   action.data,\n            }\n            yield put(reportAction.sortLateOrders(sortData));\n        };\n    } catch (e) {\n        notifyerror(e);\n        console.log(e.message);\n    }\n};\n\nfunction* sortLateOrders(action) {   \n    let data        =   action.data.searchData; \n    //console.log('Action Data : ', data);\n    let filter      =   data.filter || {};\n    let filterState =   filter.filterKeys.State || [];\n    let filterArea  =   filter.filterKeys.Area || [];\n    let filterStore =   filter.filterKeys.Store || [];\n    let order_by    =   data.order_by || 'complete_after';\n    let order       =   data.format || 'asc';\n    let result      =   action.data.unsortedLateOrders;\n    let tasks       =   {};\n    let count       =   action.data.count || 0;\n    let listType = '';\n    if(data.type === 'store'){\n        listType          =   'Zonewise';\n        if(result.length > 0) {\n            result.map((val, key) => {\n                //count++;\n                if(!!!tasks[val.state_code]) {\n                    tasks[val.state_code]   =   {};\n                    tasks[val.state_code][val.store_id]   =   {\n                                name        :   val.store,\n                                id          :   val.store_id,\n                                orders      :   [],\n                                a           :   0,\n                                b           :   0,\n                                c           :   0,\n                                d           :   0,\n                                total       :   0\n                    };\n                } else {\n                    if(!!!tasks[val.state_code][val.store_id]) {\n                        tasks[val.state_code][val.store_id]   =   {\n                            name        :   val.store,\n                            id          :   val.store_id,\n                            orders      :   [],\n                            a           :   0,\n                            b           :   0,\n                            c           :   0,\n                            d           :   0,\n                            total       :   0\n                        };\n                    }\n                }\n\n                tasks[val.state_code][val.store_id].total++;\n                let lateClass       =   '';\n                if(val.time_diff >= 0 && val.time_diff <= 20) {\n                    lateClass       =   'ready';\n                    tasks[val.state_code][val.store_id].b++;\n                } else if(val.time_diff > 20 && val.time_diff <= 30) {\n                    lateClass       =   'shopping';\n                    tasks[val.state_code][val.store_id].c++;\n                } else if(val.time_diff > 30) {\n                    lateClass       =   'not_ready';\n                    tasks[val.state_code][val.store_id].d++;\n                } else {\n                    tasks[val.state_code][val.store_id].a++;\n                }\n                \n                tasks[val.state_code][val.store_id].orders.push({\n                    timestamp               :   moment(val.created_at).format('X'),\n                    created_at              :   formatDate(val.created_at),\n                    cust_name               :   val.cust_name.toLowerCase(),\n                    customer_name           :   val.cust_name,\n                    order_number            :   val.order_number,\n                    store                   :   val.store,\n                    store_id                :   val.store_id,\n                    complete_before         :   formatDate(val.complete_before),\n                    complete_after          :   formatDate(val.complete_after),\n                    delivery_time           :   formatDate(val.delivery_time),\n                    driver_wait             :   val.driver_wait,\n                    recpnt_task_start_time  :   formatDate(val.recpnt_task_start_time),\n                    lateClass               :   lateClass,\n                    time_diff               :   val.time_diff,\n                    uuid                    :   val.uuid\n                });\n            });\n        }\n        let temp                        =   {};\n        _.each(tasks, (val, key) => {\n            _.each(val, (vz, kz) => {\n                tasks[key][kz].orders   =   _.orderBy(tasks[key][kz].orders, [o => o[order_by]], [order]);\n            });\n            temp[key]                   =   _.sortBy(tasks[key], (o) => { return o.store; })\n        });\n        tasks                           =   temp;\n    } else if(data.type === 'place'){\n        if(filterState.length > 0 && filterArea.length === 0){ \n            listType         =   'Statewise'; \n            if(result.length > 0) {\n                result.map((val, key) => {\n                    //count++;\n                    if(!!!tasks[val.state_code]) {\n                        tasks[val.state_code]   =   {\n                            name        :   val.state_code,\n                            orders      :   [],\n                            a           :   0,\n                            b           :   0,\n                            c           :   0,\n                            d           :   0,\n                            total       :   0\n                        };\n                    }\n\n                    tasks[val.state_code].total++;\n                    let lateClass       =   '';\n                    if(val.time_diff >= 0 && val.time_diff <= 20) {\n                        lateClass       =   'ready';\n                        tasks[val.state_code].b++;\n                    } else if(val.time_diff > 20 && val.time_diff <= 30) {\n                        lateClass       =   'shopping';\n                        tasks[val.state_code].c++;\n                    } else if(val.time_diff > 30) {\n                        lateClass       =   'not_ready';\n                        tasks[val.state_code].d++;\n                    } else {\n                        tasks[val.state_code].a++;\n                    }\n\n                    //console.log(tasks[val.state_code]);\n                    \n                    tasks[val.state_code].orders.push({\n                        timestamp               :   moment(val.created_at).format('X'),\n                        created_at              :   formatDate(val.created_at),\n                        cust_name               :   val.cust_name.toLowerCase(),\n                        customer_name           :   val.cust_name,\n                        order_number            :   val.order_number,\n                        store                   :   val.store,\n                        store_id                :   val.store_id,\n                        complete_before         :   formatDate(val.complete_before),\n                        complete_after          :   formatDate(val.complete_after),\n                        delivery_time           :   formatDate(val.delivery_time),\n                        driver_wait             :   val.driver_wait,\n                        recpnt_task_start_time  :   formatDate(val.recpnt_task_start_time),\n                        lateClass               :   lateClass,\n                        time_diff               :   val.time_diff,\n                        uuid                    :   val.uuid\n                    });\n                });\n            }\n            _.each(tasks, (val, key) => {\n                tasks[key].orders               =  _.orderBy(tasks[key].orders, [o => o[order_by]], [order]);\n            });\n        } else if(filterArea.length > 0) {                    \n            listType          =   'Zonewise';\n            if(result.length > 0) {\n                result.map((val, key) => {\n                    //count++;\n                    if(!!!tasks[val.state_code]) {\n                        tasks[val.state_code]   =   {};\n                        tasks[val.state_code][val.zone_id]   =   {\n                                    name        :   val.zone_name,\n                                    id          :   val.zone_id,\n                                    orders      :   [],\n                                    a           :   0,\n                                    b           :   0,\n                                    c           :   0,\n                                    d           :   0,\n                                    total       :   0\n                        };\n                    } else {\n                        if(!!!tasks[val.state_code][val.zone_id]) {\n                            tasks[val.state_code][val.zone_id]   =   {\n                                name        :   val.zone_name,\n                                id          :   val.zone_id,\n                                orders      :   [],\n                                a           :   0,\n                                b           :   0,\n                                c           :   0,\n                                d           :   0,\n                                total       :   0\n                            };\n                        }\n                    }\n\n                    let lateClass       =   '';\n                    tasks[val.state_code][val.zone_id].total++;\n                    if(val.time_diff >= 0 && val.time_diff <= 20) {\n                        tasks[val.state_code][val.zone_id].b++;\n                        lateClass       =   'ready';\n                    } else if(val.time_diff > 20 && val.time_diff <= 30) {\n                        tasks[val.state_code][val.zone_id].c++;\n                        lateClass       =   'shopping';\n                    } else if(val.time_diff > 30) {\n                        tasks[val.state_code][val.zone_id].d++;\n                        lateClass       =   'not_ready';\n                    } else {\n                        tasks[val.state_code][val.zone_id].a++;\n                    }\n                    \n                    tasks[val.state_code][val.zone_id].orders.push({\n                        timestamp               :   moment(val.created_at).format('X'),\n                        created_at              :   formatDate(val.created_at),\n                        cust_name               :   val.cust_name.toLowerCase(),\n                        customer_name           :   val.cust_name,\n                        order_number            :   val.order_number,\n                        store                   :   val.store,\n                        store_id                :   val.store_id,\n                        complete_before         :   formatDate(val.complete_before),\n                        complete_after          :   formatDate(val.complete_after),\n                        delivery_time           :   formatDate(val.delivery_time),\n                        driver_wait             :   val.driver_wait,\n                        recpnt_task_start_time  :   formatDate(val.recpnt_task_start_time),\n                        lateClass               :   lateClass,\n                        time_diff               :   val.time_diff,\n                        uuid                    :   val.uuid\n                    });\n                });\n            }\n            let temp                        =   {};\n            _.each(tasks, (val, key) => {\n                _.each(val, (vz, kz) => {\n                    //tasks[key][kz].orders   =   _.orderBy(tasks[key][kz].orders, [o => o.timestamp], ['desc'])\n                    tasks[key][kz].orders       =   _.orderBy(tasks[key][kz].orders, [o => o[order_by]], [order])\n                });\n                temp[key]                   =   _.sortBy(tasks[key], (o) => { return o.zone_name; })\n            });\n            tasks                           =   temp;\n        }\n    } else {                \n        tasks                   =   {\n            a:0,\n            b:0,\n            c:0,\n            d:0,\n            total       :   0,\n            orders: []\n        }\n        listType                =   'Uncategorized';\n        result.map((val, key) => {   \n            //count++;\n            tasks.total++;\n            let lateClass       =   '';\n            if(val.time_diff >= 0 && val.time_diff <= 20) {\n                tasks.b++;\n                lateClass       =   'ready';\n            } else if(val.time_diff > 20 && val.time_diff <= 30) {\n                lateClass       =   'shopping';\n                tasks.c++;\n            } else if(val.time_diff > 30) {\n                lateClass       =   'not_ready';\n                tasks.d++;\n            } else {\n                tasks.a++;\n            }\n            //console.log(val.time_diff, moment(val.time_diff).format(\"mm:ss\"))   \n            tasks.orders.push({\n                timestamp               :   moment(val.created_at).format('X'),\n                created_at              :   formatDate(val.created_at),\n                cust_name               :   val.cust_name.toLowerCase(),\n                customer_name           :   val.cust_name,\n                order_number            :   val.order_number,\n                store                   :   val.store,\n                store_id                :   val.store_id,\n                complete_before         :   formatDate(val.complete_before),\n                complete_after          :   formatDate(val.complete_after),\n                delivery_time           :   formatDate(val.delivery_time),\n                driver_wait             :   val.driver_wait,\n                recpnt_task_start_time  :   formatDate(val.recpnt_task_start_time),\n                lateClass               :   lateClass,\n                time_diff               :   val.time_diff,\n                uuid                    :   val.uuid\n            });\n        });\n        //tasks                           =   result.tasks || [];\n        tasks.orders                      =   _.orderBy(tasks.orders, [o => o[order_by]], [order])\n    }\n    //console.log('Saga : ', {count: count, tasks: tasks, listType: listType});\n    yield put(reportAction.listenLateOrdersSuccess({unsortedLateOrders: result, arrangedTasks: { count: count, tasks: tasks, listType: listType, pageno: data.page, sortBy: order_by, format: order}}));\n}\n\nexport function* watchReportStore() {\n    try{\n        yield takeEvery( reportConstant.GET_REPORT, getReport );\n        yield takeEvery( reportConstant.GET_ORDER, getOrder );\n        yield takeEvery( reportConstant.GET_LATE_ORDER, getLateOrders );\n        yield takeEvery( reportConstant.SORT_LATE_ORDERS, sortLateOrders );\n    } catch(e){\n        console.log(e)\n    }\n};"]},"metadata":{},"sourceType":"module"}