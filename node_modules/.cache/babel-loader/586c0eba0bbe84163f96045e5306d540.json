{"ast":null,"code":"import _regeneratorRuntime from\"/home/biplab/Desktop/foodjets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(do_login),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(watchLoginStore);import{takeEvery,put,call}from'redux-saga/effects';import*as loginConstant from'../constants';import{error as notifyerror,success as notifysuccess}from'../../../util/notify';import*as loginAction from'../actions';import{callApi}from'../../../Helper/api';import{setCookie,removeCookie,setLifetimeCookie,set as setDomainCookie}from'../../../util/cookies';import Config from'../../../config';//Do Login\nexport function do_login(action){var url,rawdata,remember,payload,result;return _regeneratorRuntime.wrap(function do_login$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;url='';url=\"auth/login\";rawdata=action.data;remember=rawdata.remember;delete rawdata.remember;_context.next=8;return call(callApi,'POST',url,rawdata);case 8:payload=_context.sent;if(!payload.data.error){_context.next=12;break;}_context.next=12;return put(loginAction.listenLoginError(payload.data.error));case 12:if(!payload.data.result){_context.next=20;break;}result=payload.data.result;notifysuccess({message:'You have successfully logged In. Please wait...'});//localStorage.setItem('user', JSON.stringify(result.user || {}));\n//console.log('States : ', Config.states);\n//localStorage.setItem('states', JSON.stringify(result.states || []));\nif(remember){removeCookie(\"foodjets_merchant\");setLifetimeCookie(result.user,'foodjets_merchant');}else{removeCookie(\"foodjets_merchant\");setCookie(result.user,'foodjets_merchant');}localStorage.setItem('states',JSON.stringify(Config.states||[]));setDomainCookie(result.user);_context.next=20;return put(loginAction.listenLoginSuccess(result));case 20:_context.next=26;break;case 22:_context.prev=22;_context.t0=_context[\"catch\"](0);notifyerror(_context.t0);console.log(_context.t0.message);case 26:case\"end\":return _context.stop();}}},_marked,null,[[0,22]]);}export function watchLoginStore(){return _regeneratorRuntime.wrap(function watchLoginStore$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return takeEvery(loginConstant.DO_LOGIN,do_login);case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 8:case\"end\":return _context2.stop();}}},_marked2,null,[[0,5]]);}","map":{"version":3,"sources":["/home/biplab/Desktop/foodjets/src/containers/Login/Saga/index.js"],"names":["do_login","watchLoginStore","takeEvery","put","call","loginConstant","error","notifyerror","success","notifysuccess","loginAction","callApi","setCookie","removeCookie","setLifetimeCookie","set","setDomainCookie","Config","action","url","rawdata","data","remember","payload","listenLoginError","result","message","user","localStorage","setItem","JSON","stringify","states","listenLoginSuccess","console","log","DO_LOGIN"],"mappings":"6LASiBA,Q,iDAgDAC,e,EAzDjB,OAASC,SAAT,CAAoBC,GAApB,CAAyBC,IAAzB,KAAqC,oBAArC,CACA,MAAO,GAAKC,CAAAA,aAAZ,KAA+B,cAA/B,CACA,OAAQC,KAAK,GAAIC,CAAAA,WAAjB,CAA8BC,OAAO,GAAIC,CAAAA,aAAzC,KAA6D,sBAA7D,CACA,MAAO,GAAKC,CAAAA,WAAZ,KAA6B,YAA7B,CACA,OAAQC,OAAR,KAAsB,qBAAtB,CACA,OAAQC,SAAR,CAAkBC,YAAlB,CAAgCC,iBAAhC,CAAmDC,GAAG,GAAIC,CAAAA,eAA1D,KAAgF,uBAAhF,CACA,MAAOC,CAAAA,MAAP,KAAmB,iBAAnB,CAEA;AACA,MAAO,SAAUjB,CAAAA,QAAV,CAAmBkB,MAAnB,2KAEKC,GAFL,CAEwB,EAFxB,CAGCA,GAAG,aAAH,CACIC,OAJL,CAIwBF,MAAM,CAACG,IAJ/B,CAKMC,QALN,CAKwBF,OAAO,CAACE,QALhC,CAMC,MAASF,CAAAA,OAAO,CAACE,QAAjB,CAND,gBAOiB,MAAMlB,CAAAA,IAAI,CAACO,OAAD,CAAU,MAAV,CAAkBQ,GAAlB,CAAuBC,OAAvB,CAAV,CAPjB,OAOOG,OAPP,mBASIA,OAAO,CAACF,IAAR,CAAaf,KATjB,2CAUK,MAAMH,CAAAA,GAAG,CAACO,WAAW,CAACc,gBAAZ,CAA6BD,OAAO,CAACF,IAAR,CAAaf,KAA1C,CAAD,CAAT,CAVL,YAcIiB,OAAO,CAACF,IAAR,CAAaI,MAdjB,0BAeSA,MAfT,CAekBF,OAAO,CAACF,IAAR,CAAaI,MAf/B,CAkBKhB,aAAa,CAAC,CAACiB,OAAO,CAAE,iDAAV,CAAD,CAAb,CACA;AACA;AACA;AAEA,GAAGJ,QAAH,CAAa,CACTT,YAAY,CAAC,mBAAD,CAAZ,CACAC,iBAAiB,CAACW,MAAM,CAACE,IAAR,CAAc,mBAAd,CAAjB,CAEH,CAJD,IAIQ,CACJd,YAAY,CAAC,mBAAD,CAAZ,CACAD,SAAS,CAACa,MAAM,CAACE,IAAR,CAAc,mBAAd,CAAT,CACH,CAODC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAA+BC,IAAI,CAACC,SAAL,CAAed,MAAM,CAACe,MAAP,EAAiB,EAAhC,CAA/B,EAEAhB,eAAe,CAACS,MAAM,CAACE,IAAR,CAAf,CAvCL,iBAwCK,MAAMxB,CAAAA,GAAG,CAACO,WAAW,CAACuB,kBAAZ,CAA+BR,MAA/B,CAAD,CAAT,CAxCL,yFA2CClB,WAAW,aAAX,CACA2B,OAAO,CAACC,GAAR,CAAY,YAAET,OAAd,EA5CD,qEAgDP,MAAO,SAAUzB,CAAAA,eAAV,gKAEC,MAAMC,CAAAA,SAAS,CAAEG,aAAa,CAAC+B,QAAhB,CAA0BpC,QAA1B,CAAf,CAFD,yFAICkC,OAAO,CAACC,GAAR,eAJD","sourcesContent":["import { takeEvery, put, call } from 'redux-saga/effects';\nimport * as loginConstant from '../constants';\nimport {error as notifyerror, success as notifysuccess} from '../../../util/notify';\nimport * as loginAction from '../actions';\nimport {callApi} from '../../../Helper/api';\nimport {setCookie,removeCookie, setLifetimeCookie, set as setDomainCookie} from '../../../util/cookies';\nimport Config from '../../../config';\n\n//Do Login\nexport function* do_login(action){\n    try {\n        let url             =  '';\n        url                 =  `auth/login`;\n        let rawdata         =  action.data ;\n        let  remember       =  rawdata.remember;  \n        delete   rawdata.remember;\n        const payload = yield call(callApi, 'POST', url, rawdata);\n        // check for error\n        if(payload.data.error){\n            yield put(loginAction.listenLoginError(payload.data.error));\n        }\n\n        // handle success result\n        if(payload.data.result){\n            let result = payload.data.result;\n\n\n            notifysuccess({message: 'You have successfully logged In. Please wait...'});\n            //localStorage.setItem('user', JSON.stringify(result.user || {}));\n            //console.log('States : ', Config.states);\n            //localStorage.setItem('states', JSON.stringify(result.states || []));\n\n            if(remember) {\n                removeCookie(\"foodjets_merchant\");\n                setLifetimeCookie(result.user, 'foodjets_merchant');\n               \n            }  else {\n                removeCookie(\"foodjets_merchant\");\n                setCookie(result.user, 'foodjets_merchant');\n            }\n\n            \n\n\n\n\n            localStorage.setItem('states', JSON.stringify(Config.states || []));\n           \n            setDomainCookie(result.user);\n            yield put(loginAction.listenLoginSuccess(result));\n        }\n    } catch (e) {\n        notifyerror(e);\n        console.log(e.message);\n    }\n}\n\nexport function* watchLoginStore() {\n    try{\n        yield takeEvery( loginConstant.DO_LOGIN, do_login );\n    } catch(e){\n        console.log(e)\n    }\n}"]},"metadata":{},"sourceType":"module"}